<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" /><title>GenericObjectPool xref</title>
<link type="text/css" rel="stylesheet" href="../../../../../stylesheet.css" />
</head>
<body>
<div id="overview"><a href="../../../../../../apidocs/org/apache/commons/pool/impl/GenericObjectPool.html">View Javadoc</a></div><pre>

<a name="1" href="#1">1</a>   <em class="comment">/*</em>
<a name="2" href="#2">2</a>   <em class="comment"> * Copyright 1999-2004 The Apache Software Foundation.</em>
<a name="3" href="#3">3</a>   <em class="comment"> * </em>
<a name="4" href="#4">4</a>   <em class="comment"> * Licensed under the Apache License, Version 2.0 (the "License");</em>
<a name="5" href="#5">5</a>   <em class="comment"> * you may not use this file except in compliance with the License.</em>
<a name="6" href="#6">6</a>   <em class="comment"> * You may obtain a copy of the License at</em>
<a name="7" href="#7">7</a>   <em class="comment"> * </em>
<a name="8" href="#8">8</a>   <em class="comment"> *      <a href="http://www.apache.org/licenses/LICENSE-2.0" target="alexandria_uri">http://www.apache.org/licenses/LICENSE-2.0</a></em>
<a name="9" href="#9">9</a>   <em class="comment"> * </em>
<a name="10" href="#10">10</a>  <em class="comment"> * Unless required by applicable law or agreed to in writing, software</em>
<a name="11" href="#11">11</a>  <em class="comment"> * distributed under the License is distributed on an "AS IS" BASIS,</em>
<a name="12" href="#12">12</a>  <em class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</em>
<a name="13" href="#13">13</a>  <em class="comment"> * See the License for the specific language governing permissions and</em>
<a name="14" href="#14">14</a>  <em class="comment"> * limitations under the License.</em>
<a name="15" href="#15">15</a>  <em class="comment"> */</em>
<a name="16" href="#16">16</a>  
<a name="17" href="#17">17</a>  <strong>package</strong> <a href="../../../../../org/apache/commons/pool/impl/package-summary.html">org.apache.commons.pool.impl</a>;
<a name="18" href="#18">18</a>  
<a name="19" href="#19">19</a>  <strong>import</strong> java.util.Iterator;
<a name="20" href="#20">20</a>  <strong>import</strong> java.util.NoSuchElementException;
<a name="21" href="#21">21</a>  <strong>import</strong> java.util.LinkedList;
<a name="22" href="#22">22</a>  <strong>import</strong> java.util.ListIterator;
<a name="23" href="#23">23</a>  <strong>import</strong> java.util.Timer;
<a name="24" href="#24">24</a>  <strong>import</strong> java.util.TimerTask;
<a name="25" href="#25">25</a>  
<a name="26" href="#26">26</a>  <strong>import</strong> org.apache.commons.pool.BaseObjectPool;
<a name="27" href="#27">27</a>  <strong>import</strong> org.apache.commons.pool.ObjectPool;
<a name="28" href="#28">28</a>  <strong>import</strong> org.apache.commons.pool.PoolableObjectFactory;
<a name="29" href="#29">29</a>  <strong>import</strong> org.apache.commons.pool.impl.GenericKeyedObjectPool.ObjectTimestampPair;
<a name="30" href="#30">30</a>  
<a name="31" href="#31">31</a>  <em>/**<em>*</em></em>
<a name="32" href="#32">32</a>  <em> * A configurable {@link ObjectPool} implementation.</em>
<a name="33" href="#33">33</a>  <em> * &lt;p></em>
<a name="34" href="#34">34</a>  <em> * When coupled with the appropriate {@link PoolableObjectFactory},</em>
<a name="35" href="#35">35</a>  <em> * &lt;tt>GenericObjectPool&lt;/tt> provides robust pooling functionality for</em>
<a name="36" href="#36">36</a>  <em> * arbitrary objects.</em>
<a name="37" href="#37">37</a>  <em> * &lt;p></em>
<a name="38" href="#38">38</a>  <em> * A &lt;tt>GenericObjectPool&lt;/tt> provides a number of configurable parameters:</em>
<a name="39" href="#39">39</a>  <em> * &lt;ul></em>
<a name="40" href="#40">40</a>  <em> *  &lt;li></em>
<a name="41" href="#41">41</a>  <em> *    {@link #setMaxActive &lt;i>maxActive&lt;/i>} controls the maximum number of objects that can</em>
<a name="42" href="#42">42</a>  <em> *    be borrowed from the pool at one time.  When non-positive, there</em>
<a name="43" href="#43">43</a>  <em> *    is no limit to the number of objects that may be active at one time.</em>
<a name="44" href="#44">44</a>  <em> *    When {@link #setMaxActive &lt;i>maxActive&lt;/i>} is exceeded, the pool is said to be exhausted.</em>
<a name="45" href="#45">45</a>  <em> *  &lt;/li></em>
<a name="46" href="#46">46</a>  <em> *  &lt;li></em>
<a name="47" href="#47">47</a>  <em> *    {@link #setMaxIdle &lt;i>maxIdle&lt;/i>} controls the maximum number of objects that can</em>
<a name="48" href="#48">48</a>  <em> *    sit idle in the pool at any time.  When negative, there</em>
<a name="49" href="#49">49</a>  <em> *    is no limit to the number of objects that may be idle at one time.</em>
<a name="50" href="#50">50</a>  <em> *  &lt;/li></em>
<a name="51" href="#51">51</a>  <em> *  &lt;li></em>
<a name="52" href="#52">52</a>  <em> *    {@link #setWhenExhaustedAction &lt;i>whenExhaustedAction&lt;/i>} specifies the</em>
<a name="53" href="#53">53</a>  <em> *    behaviour of the {@link #borrowObject} method when the pool is exhausted:</em>
<a name="54" href="#54">54</a>  <em> *    &lt;ul></em>
<a name="55" href="#55">55</a>  <em> *    &lt;li></em>
<a name="56" href="#56">56</a>  <em> *      When {@link #setWhenExhaustedAction &lt;i>whenExhaustedAction&lt;/i>} is</em>
<a name="57" href="#57">57</a>  <em> *      {@link #WHEN_EXHAUSTED_FAIL}, {@link #borrowObject} will throw</em>
<a name="58" href="#58">58</a>  <em> *      a {@link NoSuchElementException}</em>
<a name="59" href="#59">59</a>  <em> *    &lt;/li></em>
<a name="60" href="#60">60</a>  <em> *    &lt;li></em>
<a name="61" href="#61">61</a>  <em> *      When {@link #setWhenExhaustedAction &lt;i>whenExhaustedAction&lt;/i>} is</em>
<a name="62" href="#62">62</a>  <em> *      {@link #WHEN_EXHAUSTED_GROW}, {@link #borrowObject} will create a new</em>
<a name="63" href="#63">63</a>  <em> *      object and return it(essentially making {@link #setMaxActive &lt;i>maxActive&lt;/i>}</em>
<a name="64" href="#64">64</a>  <em> *      meaningless.)</em>
<a name="65" href="#65">65</a>  <em> *    &lt;/li></em>
<a name="66" href="#66">66</a>  <em> *    &lt;li></em>
<a name="67" href="#67">67</a>  <em> *      When {@link #setWhenExhaustedAction &lt;i>whenExhaustedAction&lt;/i>}</em>
<a name="68" href="#68">68</a>  <em> *      is {@link #WHEN_EXHAUSTED_BLOCK}, {@link #borrowObject} will block</em>
<a name="69" href="#69">69</a>  <em> *      (invoke {@link Object#wait} until a new or idle object is available.</em>
<a name="70" href="#70">70</a>  <em> *      If a positive {@link #setMaxWait &lt;i>maxWait&lt;/i>}</em>
<a name="71" href="#71">71</a>  <em> *      value is supplied, the {@link #borrowObject} will block for at</em>
<a name="72" href="#72">72</a>  <em> *      most that many milliseconds, after which a {@link NoSuchElementException}</em>
<a name="73" href="#73">73</a>  <em> *      will be thrown.  If {@link #setMaxWait &lt;i>maxWait&lt;/i>} is non-positive,</em>
<a name="74" href="#74">74</a>  <em> *      the {@link #borrowObject} method will block indefinitely.</em>
<a name="75" href="#75">75</a>  <em> *    &lt;/li></em>
<a name="76" href="#76">76</a>  <em> *    &lt;/ul></em>
<a name="77" href="#77">77</a>  <em> *  &lt;/li></em>
<a name="78" href="#78">78</a>  <em> *  &lt;li></em>
<a name="79" href="#79">79</a>  <em> *    When {@link #setTestOnBorrow &lt;i>testOnBorrow&lt;/i>} is set, the pool will</em>
<a name="80" href="#80">80</a>  <em> *    attempt to validate each object before it is returned from the</em>
<a name="81" href="#81">81</a>  <em> *    {@link #borrowObject} method. (Using the provided factory's</em>
<a name="82" href="#82">82</a>  <em> *    {@link PoolableObjectFactory#validateObject} method.)  Objects that fail</em>
<a name="83" href="#83">83</a>  <em> *    to validate will be dropped from the pool, and a different object will</em>
<a name="84" href="#84">84</a>  <em> *    be borrowed.</em>
<a name="85" href="#85">85</a>  <em> *  &lt;/li></em>
<a name="86" href="#86">86</a>  <em> *  &lt;li></em>
<a name="87" href="#87">87</a>  <em> *    When {@link #setTestOnReturn &lt;i>testOnReturn&lt;/i>} is set, the pool will</em>
<a name="88" href="#88">88</a>  <em> *    attempt to validate each object before it is returned to the pool in the</em>
<a name="89" href="#89">89</a>  <em> *    {@link #returnObject} method. (Using the provided factory's</em>
<a name="90" href="#90">90</a>  <em> *    {@link PoolableObjectFactory#validateObject}</em>
<a name="91" href="#91">91</a>  <em> *    method.)  Objects that fail to validate will be dropped from the pool.</em>
<a name="92" href="#92">92</a>  <em> *  &lt;/li></em>
<a name="93" href="#93">93</a>  <em> * &lt;/ul></em>
<a name="94" href="#94">94</a>  <em> * &lt;p></em>
<a name="95" href="#95">95</a>  <em> * Optionally, one may configure the pool to examine and possibly evict objects as they</em>
<a name="96" href="#96">96</a>  <em> * sit idle in the pool.  This is performed by an "idle object eviction" thread, which</em>
<a name="97" href="#97">97</a>  <em> * runs asychronously.  The idle object eviction thread may be configured using the</em>
<a name="98" href="#98">98</a>  <em> * following attributes:</em>
<a name="99" href="#99">99</a>  <em> * &lt;ul></em>
<a name="100" href="#100">100</a> <em> *  &lt;li></em>
<a name="101" href="#101">101</a> <em> *   {@link #setTimeBetweenEvictionRunsMillis &lt;i>timeBetweenEvictionRunsMillis&lt;/i>}</em>
<a name="102" href="#102">102</a> <em> *   indicates how long the eviction thread should sleep before "runs" of examining</em>
<a name="103" href="#103">103</a> <em> *   idle objects.  When non-positive, no eviction thread will be launched.</em>
<a name="104" href="#104">104</a> <em> *  &lt;/li></em>
<a name="105" href="#105">105</a> <em> *  &lt;li></em>
<a name="106" href="#106">106</a> <em> *   {@link #setMinEvictableIdleTimeMillis &lt;i>minEvictableIdleTimeMillis&lt;/i>}</em>
<a name="107" href="#107">107</a> <em> *   specifies the minimum amount of time that an object may sit idle in the pool</em>
<a name="108" href="#108">108</a> <em> *   before it is eligable for eviction due to idle time.  When non-positive, no object</em>
<a name="109" href="#109">109</a> <em> *   will be dropped from the pool due to idle time alone.</em>
<a name="110" href="#110">110</a> <em> *  &lt;/li></em>
<a name="111" href="#111">111</a> <em> *  &lt;li></em>
<a name="112" href="#112">112</a> <em> *   {@link #setTestWhileIdle &lt;i>testWhileIdle&lt;/i>} indicates whether or not idle</em>
<a name="113" href="#113">113</a> <em> *   objects should be validated using the factory's</em>
<a name="114" href="#114">114</a> <em> *   {@link PoolableObjectFactory#validateObject} method.  Objects</em>
<a name="115" href="#115">115</a> <em> *   that fail to validate will be dropped from the pool.</em>
<a name="116" href="#116">116</a> <em> *  &lt;/li></em>
<a name="117" href="#117">117</a> <em> * &lt;/ul></em>
<a name="118" href="#118">118</a> <em> * &lt;p></em>
<a name="119" href="#119">119</a> <em> * GenericObjectPool is not usable without a {@link PoolableObjectFactory}.  A</em>
<a name="120" href="#120">120</a> <em> * non-&lt;code>null&lt;/code> factory must be provided either as a constructor argument</em>
<a name="121" href="#121">121</a> <em> * or via a call to {@link #setFactory} before the pool is used.</em>
<a name="122" href="#122">122</a> <em> *</em>
<a name="123" href="#123">123</a> <em> * @see GenericKeyedObjectPool</em>
<a name="124" href="#124">124</a> <em> * @author Rodney Waldhoff</em>
<a name="125" href="#125">125</a> <em> * @author Dirk Verbeeck</em>
<a name="126" href="#126">126</a> <em> * @version $Revision: 4672 $ $Date: 2006-09-27 00:03:16 +0000 (Wed, 27 Sep 2006) $</em>
<a name="127" href="#127">127</a> <em> */</em>
<a name="128" href="#128">128</a> @SuppressWarnings(<span class="string">"unchecked"</span>)
<a name="129" href="#129">129</a> <strong>public</strong> <strong>class</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a> <strong>extends</strong> BaseObjectPool implements ObjectPool {
<a name="130" href="#130">130</a> 
<a name="131" href="#131">131</a>     <em class="comment">//--- public constants -------------------------------------------</em>
<a name="132" href="#132">132</a> 
<a name="133" href="#133">133</a>     <em>/**<em>*</em></em>
<a name="134" href="#134">134</a> <em>     * A "when exhausted action" type indicating that when the pool is</em>
<a name="135" href="#135">135</a> <em>     * exhausted (i.e., the maximum number of active objects has</em>
<a name="136" href="#136">136</a> <em>     * been reached), the {@link #borrowObject}</em>
<a name="137" href="#137">137</a> <em>     * method should fail, throwing a {@link NoSuchElementException}.</em>
<a name="138" href="#138">138</a> <em>     * @see #WHEN_EXHAUSTED_BLOCK</em>
<a name="139" href="#139">139</a> <em>     * @see #WHEN_EXHAUSTED_GROW</em>
<a name="140" href="#140">140</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="141" href="#141">141</a> <em>     */</em>
<a name="142" href="#142">142</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> byte WHEN_EXHAUSTED_FAIL   = 0;
<a name="143" href="#143">143</a> 
<a name="144" href="#144">144</a>     <em>/**<em>*</em></em>
<a name="145" href="#145">145</a> <em>     * A "when exhausted action" type indicating that when the pool</em>
<a name="146" href="#146">146</a> <em>     * is exhausted (i.e., the maximum number</em>
<a name="147" href="#147">147</a> <em>     * of active objects has been reached), the {@link #borrowObject}</em>
<a name="148" href="#148">148</a> <em>     * method should block until a new object is available, or the</em>
<a name="149" href="#149">149</a> <em>     * {@link #getMaxWait maximum wait time} has been reached.</em>
<a name="150" href="#150">150</a> <em>     * @see #WHEN_EXHAUSTED_FAIL</em>
<a name="151" href="#151">151</a> <em>     * @see #WHEN_EXHAUSTED_GROW</em>
<a name="152" href="#152">152</a> <em>     * @see #setMaxWait</em>
<a name="153" href="#153">153</a> <em>     * @see #getMaxWait</em>
<a name="154" href="#154">154</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="155" href="#155">155</a> <em>     */</em>
<a name="156" href="#156">156</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> byte WHEN_EXHAUSTED_BLOCK  = 1;
<a name="157" href="#157">157</a> 
<a name="158" href="#158">158</a>     <em>/**<em>*</em></em>
<a name="159" href="#159">159</a> <em>     * A "when exhausted action" type indicating that when the pool is</em>
<a name="160" href="#160">160</a> <em>     * exhausted (i.e., the maximum number</em>
<a name="161" href="#161">161</a> <em>     * of active objects has been reached), the {@link #borrowObject}</em>
<a name="162" href="#162">162</a> <em>     * method should simply create a new object anyway.</em>
<a name="163" href="#163">163</a> <em>     * @see #WHEN_EXHAUSTED_FAIL</em>
<a name="164" href="#164">164</a> <em>     * @see #WHEN_EXHAUSTED_GROW</em>
<a name="165" href="#165">165</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="166" href="#166">166</a> <em>     */</em>
<a name="167" href="#167">167</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> byte WHEN_EXHAUSTED_GROW   = 2;
<a name="168" href="#168">168</a> 
<a name="169" href="#169">169</a>     <em>/**<em>*</em></em>
<a name="170" href="#170">170</a> <em>     * The default cap on the number of "sleeping" instances in the pool.</em>
<a name="171" href="#171">171</a> <em>     * @see #getMaxIdle</em>
<a name="172" href="#172">172</a> <em>     * @see #setMaxIdle</em>
<a name="173" href="#173">173</a> <em>     */</em>
<a name="174" href="#174">174</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>int</strong> DEFAULT_MAX_IDLE  = 8;
<a name="175" href="#175">175</a> 
<a name="176" href="#176">176</a>     <em>/**<em>*</em></em>
<a name="177" href="#177">177</a> <em>     * The default minimum number of "sleeping" instances in the pool</em>
<a name="178" href="#178">178</a> <em>     * before before the evictor thread (if active) spawns new objects.</em>
<a name="179" href="#179">179</a> <em>     * @see #getMinIdle</em>
<a name="180" href="#180">180</a> <em>     * @see #setMinIdle</em>
<a name="181" href="#181">181</a> <em>     */</em>
<a name="182" href="#182">182</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>int</strong> DEFAULT_MIN_IDLE = 0;
<a name="183" href="#183">183</a> 
<a name="184" href="#184">184</a>     <em>/**<em>*</em></em>
<a name="185" href="#185">185</a> <em>     * The default cap on the total number of active instances from the pool.</em>
<a name="186" href="#186">186</a> <em>     * @see #getMaxActive</em>
<a name="187" href="#187">187</a> <em>     */</em>
<a name="188" href="#188">188</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>int</strong> DEFAULT_MAX_ACTIVE  = 8;
<a name="189" href="#189">189</a> 
<a name="190" href="#190">190</a>     <em>/**<em>*</em></em>
<a name="191" href="#191">191</a> <em>     * The default "when exhausted action" for the pool.</em>
<a name="192" href="#192">192</a> <em>     * @see #WHEN_EXHAUSTED_BLOCK</em>
<a name="193" href="#193">193</a> <em>     * @see #WHEN_EXHAUSTED_FAIL</em>
<a name="194" href="#194">194</a> <em>     * @see #WHEN_EXHAUSTED_GROW</em>
<a name="195" href="#195">195</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="196" href="#196">196</a> <em>     */</em>
<a name="197" href="#197">197</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> byte DEFAULT_WHEN_EXHAUSTED_ACTION = WHEN_EXHAUSTED_BLOCK;
<a name="198" href="#198">198</a> 
<a name="199" href="#199">199</a>     <em>/**<em>*</em></em>
<a name="200" href="#200">200</a> <em>     * The default maximum amount of time (in millis) the</em>
<a name="201" href="#201">201</a> <em>     * {@link #borrowObject} method should block before throwing</em>
<a name="202" href="#202">202</a> <em>     * an exception when the pool is exhausted and the</em>
<a name="203" href="#203">203</a> <em>     * {@link #getWhenExhaustedAction "when exhausted" action} is</em>
<a name="204" href="#204">204</a> <em>     * {@link #WHEN_EXHAUSTED_BLOCK}.</em>
<a name="205" href="#205">205</a> <em>     * @see #getMaxWait</em>
<a name="206" href="#206">206</a> <em>     * @see #setMaxWait</em>
<a name="207" href="#207">207</a> <em>     */</em>
<a name="208" href="#208">208</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>long</strong> DEFAULT_MAX_WAIT = -1L;
<a name="209" href="#209">209</a> 
<a name="210" href="#210">210</a>     <em>/**<em>*</em></em>
<a name="211" href="#211">211</a> <em>     * The default "test on borrow" value.</em>
<a name="212" href="#212">212</a> <em>     * @see #getTestOnBorrow</em>
<a name="213" href="#213">213</a> <em>     * @see #setTestOnBorrow</em>
<a name="214" href="#214">214</a> <em>     */</em>
<a name="215" href="#215">215</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>boolean</strong> DEFAULT_TEST_ON_BORROW = false;
<a name="216" href="#216">216</a> 
<a name="217" href="#217">217</a>     <em>/**<em>*</em></em>
<a name="218" href="#218">218</a> <em>     * The default "test on return" value.</em>
<a name="219" href="#219">219</a> <em>     * @see #getTestOnReturn</em>
<a name="220" href="#220">220</a> <em>     * @see #setTestOnReturn</em>
<a name="221" href="#221">221</a> <em>     */</em>
<a name="222" href="#222">222</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>boolean</strong> DEFAULT_TEST_ON_RETURN = false;
<a name="223" href="#223">223</a> 
<a name="224" href="#224">224</a>     <em>/**<em>*</em></em>
<a name="225" href="#225">225</a> <em>     * The default "test while idle" value.</em>
<a name="226" href="#226">226</a> <em>     * @see #getTestWhileIdle</em>
<a name="227" href="#227">227</a> <em>     * @see #setTestWhileIdle</em>
<a name="228" href="#228">228</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="229" href="#229">229</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="230" href="#230">230</a> <em>     */</em>
<a name="231" href="#231">231</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>boolean</strong> DEFAULT_TEST_WHILE_IDLE = false;
<a name="232" href="#232">232</a> 
<a name="233" href="#233">233</a>     <em>/**<em>*</em></em>
<a name="234" href="#234">234</a> <em>     * The default "time between eviction runs" value.</em>
<a name="235" href="#235">235</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="236" href="#236">236</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="237" href="#237">237</a> <em>     */</em>
<a name="238" href="#238">238</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>long</strong> DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS = -1L;
<a name="239" href="#239">239</a> 
<a name="240" href="#240">240</a>     <em>/**<em>*</em></em>
<a name="241" href="#241">241</a> <em>     * The default number of objects to examine per run in the</em>
<a name="242" href="#242">242</a> <em>     * idle object evictor.</em>
<a name="243" href="#243">243</a> <em>     * @see #getNumTestsPerEvictionRun</em>
<a name="244" href="#244">244</a> <em>     * @see #setNumTestsPerEvictionRun</em>
<a name="245" href="#245">245</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="246" href="#246">246</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="247" href="#247">247</a> <em>     */</em>
<a name="248" href="#248">248</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>int</strong> DEFAULT_NUM_TESTS_PER_EVICTION_RUN = 3;
<a name="249" href="#249">249</a> 
<a name="250" href="#250">250</a>     <em>/**<em>*</em></em>
<a name="251" href="#251">251</a> <em>     * The default value for {@link #getMinEvictableIdleTimeMillis}.</em>
<a name="252" href="#252">252</a> <em>     * @see #getMinEvictableIdleTimeMillis</em>
<a name="253" href="#253">253</a> <em>     * @see #setMinEvictableIdleTimeMillis</em>
<a name="254" href="#254">254</a> <em>     */</em>
<a name="255" href="#255">255</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>long</strong> DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS = 1000L * 60L * 30L;
<a name="256" href="#256">256</a> 
<a name="257" href="#257">257</a>     <em>/**<em>*</em></em>
<a name="258" href="#258">258</a> <em>     * The default value for {@link #getSoftMinEvictableIdleTimeMillis}.</em>
<a name="259" href="#259">259</a> <em>     * @see #getSoftMinEvictableIdleTimeMillis</em>
<a name="260" href="#260">260</a> <em>     * @see #setSoftMinEvictableIdleTimeMillis</em>
<a name="261" href="#261">261</a> <em>     */</em>
<a name="262" href="#262">262</a>     <strong>public</strong> <strong>static</strong> <strong>final</strong> <strong>long</strong> DEFAULT_SOFT_MIN_EVICTABLE_IDLE_TIME_MILLIS = -1;
<a name="263" href="#263">263</a> 
<a name="264" href="#264">264</a>     <em class="comment">//--- package constants -------------------------------------------</em>
<a name="265" href="#265">265</a> 
<a name="266" href="#266">266</a>     <em>/**<em>*</em></em>
<a name="267" href="#267">267</a> <em>     * Idle object evition Timer. Shared between all {@link GenericObjectPool}s and {@link GenericKeyedObjectPool} s.</em>
<a name="268" href="#268">268</a> <em>     */</em>
<a name="269" href="#269">269</a>     <strong>static</strong> <strong>final</strong> Timer EVICTION_TIMER = <strong>new</strong> Timer(<strong>true</strong>);
<a name="270" href="#270">270</a> 
<a name="271" href="#271">271</a>     <em class="comment">//--- constructors -----------------------------------------------</em>
<a name="272" href="#272">272</a> 
<a name="273" href="#273">273</a>     <em>/**<em>*</em></em>
<a name="274" href="#274">274</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt>.</em>
<a name="275" href="#275">275</a> <em>     */</em>
<a name="276" href="#276">276</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>() {
<a name="277" href="#277">277</a>         <strong>this</strong>(<strong>null</strong>,DEFAULT_MAX_ACTIVE,DEFAULT_WHEN_EXHAUSTED_ACTION,DEFAULT_MAX_WAIT,DEFAULT_MAX_IDLE,DEFAULT_MIN_IDLE,DEFAULT_TEST_ON_BORROW,DEFAULT_TEST_ON_RETURN,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="278" href="#278">278</a>     }
<a name="279" href="#279">279</a> 
<a name="280" href="#280">280</a>     <em>/**<em>*</em></em>
<a name="281" href="#281">281</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="282" href="#282">282</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="283" href="#283">283</a> <em>     */</em>
<a name="284" href="#284">284</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory) {
<a name="285" href="#285">285</a>         <strong>this</strong>(factory,DEFAULT_MAX_ACTIVE,DEFAULT_WHEN_EXHAUSTED_ACTION,DEFAULT_MAX_WAIT,DEFAULT_MAX_IDLE,DEFAULT_MIN_IDLE,DEFAULT_TEST_ON_BORROW,DEFAULT_TEST_ON_RETURN,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="286" href="#286">286</a>     }
<a name="287" href="#287">287</a> 
<a name="288" href="#288">288</a>     <em>/**<em>*</em></em>
<a name="289" href="#289">289</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="290" href="#290">290</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="291" href="#291">291</a> <em>     * @param config a non-&lt;tt>null&lt;/tt> {@link GenericObjectPool.Config} describing my configuration</em>
<a name="292" href="#292">292</a> <em>     */</em>
<a name="293" href="#293">293</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, GenericObjectPool.Config config) {
<a name="294" href="#294">294</a>         <strong>this</strong>(factory,config.maxActive,config.whenExhaustedAction,config.maxWait,config.maxIdle,config.minIdle,config.testOnBorrow,config.testOnReturn,config.timeBetweenEvictionRunsMillis,config.numTestsPerEvictionRun,config.minEvictableIdleTimeMillis,config.testWhileIdle);
<a name="295" href="#295">295</a>     }
<a name="296" href="#296">296</a> 
<a name="297" href="#297">297</a>     <em>/**<em>*</em></em>
<a name="298" href="#298">298</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="299" href="#299">299</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="300" href="#300">300</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="301" href="#301">301</a> <em>     */</em>
<a name="302" href="#302">302</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive) {
<a name="303" href="#303">303</a>         <strong>this</strong>(factory,maxActive,DEFAULT_WHEN_EXHAUSTED_ACTION,DEFAULT_MAX_WAIT,DEFAULT_MAX_IDLE,DEFAULT_MIN_IDLE,DEFAULT_TEST_ON_BORROW,DEFAULT_TEST_ON_RETURN,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="304" href="#304">304</a>     }
<a name="305" href="#305">305</a> 
<a name="306" href="#306">306</a>     <em>/**<em>*</em></em>
<a name="307" href="#307">307</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="308" href="#308">308</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="309" href="#309">309</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="310" href="#310">310</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #getWhenExhaustedAction})</em>
<a name="311" href="#311">311</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #getMaxWait})</em>
<a name="312" href="#312">312</a> <em>     */</em>
<a name="313" href="#313">313</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait) {
<a name="314" href="#314">314</a>         <strong>this</strong>(factory,maxActive,whenExhaustedAction,maxWait,DEFAULT_MAX_IDLE,DEFAULT_MIN_IDLE,DEFAULT_TEST_ON_BORROW,DEFAULT_TEST_ON_RETURN,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="315" href="#315">315</a>     }
<a name="316" href="#316">316</a> 
<a name="317" href="#317">317</a>     <em>/**<em>*</em></em>
<a name="318" href="#318">318</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="319" href="#319">319</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="320" href="#320">320</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="321" href="#321">321</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #getWhenExhaustedAction})</em>
<a name="322" href="#322">322</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #getMaxWait})</em>
<a name="323" href="#323">323</a> <em>     * @param testOnBorrow whether or not to validate objects before they are returned by the {@link #borrowObject} method (see {@link #getTestOnBorrow})</em>
<a name="324" href="#324">324</a> <em>     * @param testOnReturn whether or not to validate objects after they are returned to the {@link #returnObject} method (see {@link #getTestOnReturn})</em>
<a name="325" href="#325">325</a> <em>     */</em>
<a name="326" href="#326">326</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait, <strong>boolean</strong> testOnBorrow, <strong>boolean</strong> testOnReturn) {
<a name="327" href="#327">327</a>         <strong>this</strong>(factory,maxActive,whenExhaustedAction,maxWait,DEFAULT_MAX_IDLE,DEFAULT_MIN_IDLE,testOnBorrow,testOnReturn,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="328" href="#328">328</a>     }
<a name="329" href="#329">329</a> 
<a name="330" href="#330">330</a>     <em>/**<em>*</em></em>
<a name="331" href="#331">331</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="332" href="#332">332</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="333" href="#333">333</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="334" href="#334">334</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #getWhenExhaustedAction})</em>
<a name="335" href="#335">335</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #getMaxWait})</em>
<a name="336" href="#336">336</a> <em>     * @param maxIdle the maximum number of idle objects in my pool (see {@link #getMaxIdle})</em>
<a name="337" href="#337">337</a> <em>     */</em>
<a name="338" href="#338">338</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait, <strong>int</strong> maxIdle) {
<a name="339" href="#339">339</a>         <strong>this</strong>(factory,maxActive,whenExhaustedAction,maxWait,maxIdle,DEFAULT_MIN_IDLE,DEFAULT_TEST_ON_BORROW,DEFAULT_TEST_ON_RETURN,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="340" href="#340">340</a>     }
<a name="341" href="#341">341</a> 
<a name="342" href="#342">342</a>     <em>/**<em>*</em></em>
<a name="343" href="#343">343</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="344" href="#344">344</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="345" href="#345">345</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="346" href="#346">346</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #getWhenExhaustedAction})</em>
<a name="347" href="#347">347</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #getMaxWait})</em>
<a name="348" href="#348">348</a> <em>     * @param maxIdle the maximum number of idle objects in my pool (see {@link #getMaxIdle})</em>
<a name="349" href="#349">349</a> <em>     * @param testOnBorrow whether or not to validate objects before they are returned by the {@link #borrowObject} method (see {@link #getTestOnBorrow})</em>
<a name="350" href="#350">350</a> <em>     * @param testOnReturn whether or not to validate objects after they are returned to the {@link #returnObject} method (see {@link #getTestOnReturn})</em>
<a name="351" href="#351">351</a> <em>     */</em>
<a name="352" href="#352">352</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait, <strong>int</strong> maxIdle, <strong>boolean</strong> testOnBorrow, <strong>boolean</strong> testOnReturn) {
<a name="353" href="#353">353</a>         <strong>this</strong>(factory,maxActive,whenExhaustedAction,maxWait,maxIdle,DEFAULT_MIN_IDLE,testOnBorrow,testOnReturn,DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS,DEFAULT_NUM_TESTS_PER_EVICTION_RUN,DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS,DEFAULT_TEST_WHILE_IDLE);
<a name="354" href="#354">354</a>     }
<a name="355" href="#355">355</a> 
<a name="356" href="#356">356</a>     <em>/**<em>*</em></em>
<a name="357" href="#357">357</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="358" href="#358">358</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="359" href="#359">359</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="360" href="#360">360</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #setWhenExhaustedAction})</em>
<a name="361" href="#361">361</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #setMaxWait})</em>
<a name="362" href="#362">362</a> <em>     * @param maxIdle the maximum number of idle objects in my pool (see {@link #setMaxIdle})</em>
<a name="363" href="#363">363</a> <em>     * @param testOnBorrow whether or not to validate objects before they are returned by the {@link #borrowObject} method (see {@link #setTestOnBorrow})</em>
<a name="364" href="#364">364</a> <em>     * @param testOnReturn whether or not to validate objects after they are returned to the {@link #returnObject} method (see {@link #setTestOnReturn})</em>
<a name="365" href="#365">365</a> <em>     * @param timeBetweenEvictionRunsMillis the amount of time (in milliseconds) to sleep between examining idle objects for eviction (see {@link #setTimeBetweenEvictionRunsMillis})</em>
<a name="366" href="#366">366</a> <em>     * @param numTestsPerEvictionRun the number of idle objects to examine per run within the idle object eviction thread (if any) (see {@link #setNumTestsPerEvictionRun})</em>
<a name="367" href="#367">367</a> <em>     * @param minEvictableIdleTimeMillis the minimum number of milliseconds an object can sit idle in the pool before it is eligable for evcition (see {@link #setMinEvictableIdleTimeMillis})</em>
<a name="368" href="#368">368</a> <em>     * @param testWhileIdle whether or not to validate objects in the idle object eviction thread, if any (see {@link #setTestWhileIdle})</em>
<a name="369" href="#369">369</a> <em>     */</em>
<a name="370" href="#370">370</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait, <strong>int</strong> maxIdle, <strong>boolean</strong> testOnBorrow, <strong>boolean</strong> testOnReturn, <strong>long</strong> timeBetweenEvictionRunsMillis, <strong>int</strong> numTestsPerEvictionRun, <strong>long</strong> minEvictableIdleTimeMillis, <strong>boolean</strong> testWhileIdle) {
<a name="371" href="#371">371</a>         <strong>this</strong>(factory, maxActive, whenExhaustedAction, maxWait, maxIdle, DEFAULT_MIN_IDLE, testOnBorrow, testOnReturn, timeBetweenEvictionRunsMillis, numTestsPerEvictionRun, minEvictableIdleTimeMillis, testWhileIdle);
<a name="372" href="#372">372</a>     }
<a name="373" href="#373">373</a> 
<a name="374" href="#374">374</a>     <em>/**<em>*</em></em>
<a name="375" href="#375">375</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="376" href="#376">376</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="377" href="#377">377</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="378" href="#378">378</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #setWhenExhaustedAction})</em>
<a name="379" href="#379">379</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #setMaxWait})</em>
<a name="380" href="#380">380</a> <em>     * @param maxIdle the maximum number of idle objects in my pool (see {@link #setMaxIdle})</em>
<a name="381" href="#381">381</a> <em>     * @param minIdle the minimum number of idle objects in my pool (see {@link #setMinIdle})</em>
<a name="382" href="#382">382</a> <em>     * @param testOnBorrow whether or not to validate objects before they are returned by the {@link #borrowObject} method (see {@link #setTestOnBorrow})</em>
<a name="383" href="#383">383</a> <em>     * @param testOnReturn whether or not to validate objects after they are returned to the {@link #returnObject} method (see {@link #setTestOnReturn})</em>
<a name="384" href="#384">384</a> <em>     * @param timeBetweenEvictionRunsMillis the amount of time (in milliseconds) to sleep between examining idle objects for eviction (see {@link #setTimeBetweenEvictionRunsMillis})</em>
<a name="385" href="#385">385</a> <em>     * @param numTestsPerEvictionRun the number of idle objects to examine per run within the idle object eviction thread (if any) (see {@link #setNumTestsPerEvictionRun})</em>
<a name="386" href="#386">386</a> <em>     * @param minEvictableIdleTimeMillis the minimum number of milliseconds an object can sit idle in the pool before it is eligable for evcition (see {@link #setMinEvictableIdleTimeMillis})</em>
<a name="387" href="#387">387</a> <em>     * @param testWhileIdle whether or not to validate objects in the idle object eviction thread, if any (see {@link #setTestWhileIdle})</em>
<a name="388" href="#388">388</a> <em>     */</em>
<a name="389" href="#389">389</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait, <strong>int</strong> maxIdle, <strong>int</strong> minIdle, <strong>boolean</strong> testOnBorrow, <strong>boolean</strong> testOnReturn, <strong>long</strong> timeBetweenEvictionRunsMillis, <strong>int</strong> numTestsPerEvictionRun, <strong>long</strong> minEvictableIdleTimeMillis, <strong>boolean</strong> testWhileIdle) {
<a name="390" href="#390">390</a>         <strong>this</strong>(factory, maxActive, whenExhaustedAction, maxWait, maxIdle, minIdle, testOnBorrow, testOnReturn, timeBetweenEvictionRunsMillis, numTestsPerEvictionRun, minEvictableIdleTimeMillis, testWhileIdle, DEFAULT_SOFT_MIN_EVICTABLE_IDLE_TIME_MILLIS);
<a name="391" href="#391">391</a>     }
<a name="392" href="#392">392</a> 
<a name="393" href="#393">393</a>     <em>/**<em>*</em></em>
<a name="394" href="#394">394</a> <em>     * Create a new &lt;tt>GenericObjectPool&lt;/tt> using the specified values.</em>
<a name="395" href="#395">395</a> <em>     * @param factory the (possibly &lt;tt>null&lt;/tt>)PoolableObjectFactory to use to create, validate and destroy objects</em>
<a name="396" href="#396">396</a> <em>     * @param maxActive the maximum number of objects that can be borrowed from me at one time (see {@link #setMaxActive})</em>
<a name="397" href="#397">397</a> <em>     * @param whenExhaustedAction the action to take when the pool is exhausted (see {@link #setWhenExhaustedAction})</em>
<a name="398" href="#398">398</a> <em>     * @param maxWait the maximum amount of time to wait for an idle object when the pool is exhausted an and &lt;i>whenExhaustedAction&lt;/i> is {@link #WHEN_EXHAUSTED_BLOCK} (otherwise ignored) (see {@link #setMaxWait})</em>
<a name="399" href="#399">399</a> <em>     * @param maxIdle the maximum number of idle objects in my pool (see {@link #setMaxIdle})</em>
<a name="400" href="#400">400</a> <em>     * @param minIdle the minimum number of idle objects in my pool (see {@link #setMinIdle})</em>
<a name="401" href="#401">401</a> <em>     * @param testOnBorrow whether or not to validate objects before they are returned by the {@link #borrowObject} method (see {@link #setTestOnBorrow})</em>
<a name="402" href="#402">402</a> <em>     * @param testOnReturn whether or not to validate objects after they are returned to the {@link #returnObject} method (see {@link #setTestOnReturn})</em>
<a name="403" href="#403">403</a> <em>     * @param timeBetweenEvictionRunsMillis the amount of time (in milliseconds) to sleep between examining idle objects for eviction (see {@link #setTimeBetweenEvictionRunsMillis})</em>
<a name="404" href="#404">404</a> <em>     * @param numTestsPerEvictionRun the number of idle objects to examine per run within the idle object eviction thread (if any) (see {@link #setNumTestsPerEvictionRun})</em>
<a name="405" href="#405">405</a> <em>     * @param minEvictableIdleTimeMillis the minimum number of milliseconds an object can sit idle in the pool before it is eligable for evcition (see {@link #setMinEvictableIdleTimeMillis})</em>
<a name="406" href="#406">406</a> <em>     * @param testWhileIdle whether or not to validate objects in the idle object eviction thread, if any (see {@link #setTestWhileIdle})</em>
<a name="407" href="#407">407</a> <em>     * @param softMinEvictableIdleTimeMillis the minimum number of milliseconds an object can sit idle in the pool before it is eligable for evcition with the extra condition that at least "minIdle" amount of object remain in the pool. (see {@link #setSoftMinEvictableIdleTimeMillis})</em>
<a name="408" href="#408">408</a> <em>     */</em>
<a name="409" href="#409">409</a>     <strong>public</strong> <a href="../../../../../org/apache/commons/pool/impl/GenericObjectPool.html">GenericObjectPool</a>(PoolableObjectFactory factory, <strong>int</strong> maxActive, byte whenExhaustedAction, <strong>long</strong> maxWait, <strong>int</strong> maxIdle, <strong>int</strong> minIdle, <strong>boolean</strong> testOnBorrow, <strong>boolean</strong> testOnReturn, <strong>long</strong> timeBetweenEvictionRunsMillis, <strong>int</strong> numTestsPerEvictionRun, <strong>long</strong> minEvictableIdleTimeMillis, <strong>boolean</strong> testWhileIdle, <strong>long</strong> softMinEvictableIdleTimeMillis) {
<a name="410" href="#410">410</a>         _factory = factory;
<a name="411" href="#411">411</a>         _maxActive = maxActive;
<a name="412" href="#412">412</a>         <strong>switch</strong>(whenExhaustedAction) {
<a name="413" href="#413">413</a>             <strong>case</strong> WHEN_EXHAUSTED_BLOCK:
<a name="414" href="#414">414</a>             <strong>case</strong> WHEN_EXHAUSTED_FAIL:
<a name="415" href="#415">415</a>             <strong>case</strong> WHEN_EXHAUSTED_GROW:
<a name="416" href="#416">416</a>                 _whenExhaustedAction = whenExhaustedAction;
<a name="417" href="#417">417</a>                 <strong>break</strong>;
<a name="418" href="#418">418</a>             <strong>default</strong>:
<a name="419" href="#419">419</a>                 <strong>throw</strong> <strong>new</strong> IllegalArgumentException(<span class="string">"whenExhaustedAction "</span> + whenExhaustedAction + <span class="string">" not recognized."</span>);
<a name="420" href="#420">420</a>         }
<a name="421" href="#421">421</a>         _maxWait = maxWait;
<a name="422" href="#422">422</a>         _maxIdle = maxIdle;
<a name="423" href="#423">423</a>         _minIdle = minIdle;
<a name="424" href="#424">424</a>         _testOnBorrow = testOnBorrow;
<a name="425" href="#425">425</a>         _testOnReturn = testOnReturn;
<a name="426" href="#426">426</a>         _timeBetweenEvictionRunsMillis = timeBetweenEvictionRunsMillis;
<a name="427" href="#427">427</a>         _numTestsPerEvictionRun = numTestsPerEvictionRun;
<a name="428" href="#428">428</a>         _minEvictableIdleTimeMillis = minEvictableIdleTimeMillis;
<a name="429" href="#429">429</a>         _softMinEvictableIdleTimeMillis = softMinEvictableIdleTimeMillis;
<a name="430" href="#430">430</a>         _testWhileIdle = testWhileIdle;
<a name="431" href="#431">431</a> 
<a name="432" href="#432">432</a>         _pool = <strong>new</strong> LinkedList();
<a name="433" href="#433">433</a>         startEvictor(_timeBetweenEvictionRunsMillis);
<a name="434" href="#434">434</a>     }
<a name="435" href="#435">435</a> 
<a name="436" href="#436">436</a>     <em class="comment">//--- public methods ---------------------------------------------</em>
<a name="437" href="#437">437</a> 
<a name="438" href="#438">438</a>     <em class="comment">//--- configuration methods --------------------------------------</em>
<a name="439" href="#439">439</a> 
<a name="440" href="#440">440</a>     <em>/**<em>*</em></em>
<a name="441" href="#441">441</a> <em>     * Returns the cap on the total number of active instances from my pool.</em>
<a name="442" href="#442">442</a> <em>     * @return the cap on the total number of active instances from my pool.</em>
<a name="443" href="#443">443</a> <em>     * @see #setMaxActive</em>
<a name="444" href="#444">444</a> <em>     */</em>
<a name="445" href="#445">445</a>     <strong>public</strong> <strong>synchronized</strong> <strong>int</strong> getMaxActive() {
<a name="446" href="#446">446</a>         <strong>return</strong> _maxActive;
<a name="447" href="#447">447</a>     }
<a name="448" href="#448">448</a> 
<a name="449" href="#449">449</a>     <em>/**<em>*</em></em>
<a name="450" href="#450">450</a> <em>     * Sets the cap on the total number of active instances from my pool.</em>
<a name="451" href="#451">451</a> <em>     * @param maxActive The cap on the total number of active instances from my pool.</em>
<a name="452" href="#452">452</a> <em>     *                  Use a negative value for an infinite number of instances.</em>
<a name="453" href="#453">453</a> <em>     * @see #getMaxActive</em>
<a name="454" href="#454">454</a> <em>     */</em>
<a name="455" href="#455">455</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setMaxActive(<strong>int</strong> maxActive) {
<a name="456" href="#456">456</a>         _maxActive = maxActive;
<a name="457" href="#457">457</a>         notifyAll();
<a name="458" href="#458">458</a>     }
<a name="459" href="#459">459</a> 
<a name="460" href="#460">460</a>     <em>/**<em>*</em></em>
<a name="461" href="#461">461</a> <em>     * Returns the action to take when the {@link #borrowObject} method</em>
<a name="462" href="#462">462</a> <em>     * is invoked when the pool is exhausted (the maximum number</em>
<a name="463" href="#463">463</a> <em>     * of "active" objects has been reached).</em>
<a name="464" href="#464">464</a> <em>     *</em>
<a name="465" href="#465">465</a> <em>     * @return one of {@link #WHEN_EXHAUSTED_BLOCK}, {@link #WHEN_EXHAUSTED_FAIL} or {@link #WHEN_EXHAUSTED_GROW}</em>
<a name="466" href="#466">466</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="467" href="#467">467</a> <em>     */</em>
<a name="468" href="#468">468</a>     <strong>public</strong> <strong>synchronized</strong> byte getWhenExhaustedAction() {
<a name="469" href="#469">469</a>         <strong>return</strong> _whenExhaustedAction;
<a name="470" href="#470">470</a>     }
<a name="471" href="#471">471</a> 
<a name="472" href="#472">472</a>     <em>/**<em>*</em></em>
<a name="473" href="#473">473</a> <em>     * Sets the action to take when the {@link #borrowObject} method</em>
<a name="474" href="#474">474</a> <em>     * is invoked when the pool is exhausted (the maximum number</em>
<a name="475" href="#475">475</a> <em>     * of "active" objects has been reached).</em>
<a name="476" href="#476">476</a> <em>     *</em>
<a name="477" href="#477">477</a> <em>     * @param whenExhaustedAction the action code, which must be one of</em>
<a name="478" href="#478">478</a> <em>     *        {@link #WHEN_EXHAUSTED_BLOCK}, {@link #WHEN_EXHAUSTED_FAIL},</em>
<a name="479" href="#479">479</a> <em>     *        or {@link #WHEN_EXHAUSTED_GROW}</em>
<a name="480" href="#480">480</a> <em>     * @see #getWhenExhaustedAction</em>
<a name="481" href="#481">481</a> <em>     */</em>
<a name="482" href="#482">482</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setWhenExhaustedAction(byte whenExhaustedAction) {
<a name="483" href="#483">483</a>         <strong>switch</strong>(whenExhaustedAction) {
<a name="484" href="#484">484</a>             <strong>case</strong> WHEN_EXHAUSTED_BLOCK:
<a name="485" href="#485">485</a>             <strong>case</strong> WHEN_EXHAUSTED_FAIL:
<a name="486" href="#486">486</a>             <strong>case</strong> WHEN_EXHAUSTED_GROW:
<a name="487" href="#487">487</a>                 _whenExhaustedAction = whenExhaustedAction;
<a name="488" href="#488">488</a>                 notifyAll();
<a name="489" href="#489">489</a>                 <strong>break</strong>;
<a name="490" href="#490">490</a>             <strong>default</strong>:
<a name="491" href="#491">491</a>                 <strong>throw</strong> <strong>new</strong> IllegalArgumentException(<span class="string">"whenExhaustedAction "</span> + whenExhaustedAction + <span class="string">" not recognized."</span>);
<a name="492" href="#492">492</a>         }
<a name="493" href="#493">493</a>     }
<a name="494" href="#494">494</a> 
<a name="495" href="#495">495</a> 
<a name="496" href="#496">496</a>     <em>/**<em>*</em></em>
<a name="497" href="#497">497</a> <em>     * Returns the maximum amount of time (in milliseconds) the</em>
<a name="498" href="#498">498</a> <em>     * {@link #borrowObject} method should block before throwing</em>
<a name="499" href="#499">499</a> <em>     * an exception when the pool is exhausted and the</em>
<a name="500" href="#500">500</a> <em>     * {@link #setWhenExhaustedAction "when exhausted" action} is</em>
<a name="501" href="#501">501</a> <em>     * {@link #WHEN_EXHAUSTED_BLOCK}.</em>
<a name="502" href="#502">502</a> <em>     *</em>
<a name="503" href="#503">503</a> <em>     * When less than 0, the {@link #borrowObject} method</em>
<a name="504" href="#504">504</a> <em>     * may block indefinitely.</em>
<a name="505" href="#505">505</a> <em>     *</em>
<a name="506" href="#506">506</a> <em>     * @see #setMaxWait</em>
<a name="507" href="#507">507</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="508" href="#508">508</a> <em>     * @see #WHEN_EXHAUSTED_BLOCK</em>
<a name="509" href="#509">509</a> <em>     */</em>
<a name="510" href="#510">510</a>     <strong>public</strong> <strong>synchronized</strong> <strong>long</strong> getMaxWait() {
<a name="511" href="#511">511</a>         <strong>return</strong> _maxWait;
<a name="512" href="#512">512</a>     }
<a name="513" href="#513">513</a> 
<a name="514" href="#514">514</a>     <em>/**<em>*</em></em>
<a name="515" href="#515">515</a> <em>     * Sets the maximum amount of time (in milliseconds) the</em>
<a name="516" href="#516">516</a> <em>     * {@link #borrowObject} method should block before throwing</em>
<a name="517" href="#517">517</a> <em>     * an exception when the pool is exhausted and the</em>
<a name="518" href="#518">518</a> <em>     * {@link #setWhenExhaustedAction "when exhausted" action} is</em>
<a name="519" href="#519">519</a> <em>     * {@link #WHEN_EXHAUSTED_BLOCK}.</em>
<a name="520" href="#520">520</a> <em>     *</em>
<a name="521" href="#521">521</a> <em>     * When less than 0, the {@link #borrowObject} method</em>
<a name="522" href="#522">522</a> <em>     * may block indefinitely.</em>
<a name="523" href="#523">523</a> <em>     *</em>
<a name="524" href="#524">524</a> <em>     * @see #getMaxWait</em>
<a name="525" href="#525">525</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="526" href="#526">526</a> <em>     * @see #WHEN_EXHAUSTED_BLOCK</em>
<a name="527" href="#527">527</a> <em>     */</em>
<a name="528" href="#528">528</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setMaxWait(<strong>long</strong> maxWait) {
<a name="529" href="#529">529</a>         _maxWait = maxWait;
<a name="530" href="#530">530</a>         notifyAll();
<a name="531" href="#531">531</a>     }
<a name="532" href="#532">532</a> 
<a name="533" href="#533">533</a>     <em>/**<em>*</em></em>
<a name="534" href="#534">534</a> <em>     * Returns the cap on the number of "idle" instances in the pool.</em>
<a name="535" href="#535">535</a> <em>     * @return the cap on the number of "idle" instances in the pool.</em>
<a name="536" href="#536">536</a> <em>     * @see #setMaxIdle</em>
<a name="537" href="#537">537</a> <em>     */</em>
<a name="538" href="#538">538</a>     <strong>public</strong> <strong>synchronized</strong> <strong>int</strong> getMaxIdle() {
<a name="539" href="#539">539</a>         <strong>return</strong> _maxIdle;
<a name="540" href="#540">540</a>     }
<a name="541" href="#541">541</a> 
<a name="542" href="#542">542</a>     <em>/**<em>*</em></em>
<a name="543" href="#543">543</a> <em>     * Sets the cap on the number of "idle" instances in the pool.</em>
<a name="544" href="#544">544</a> <em>     * @param maxIdle The cap on the number of "idle" instances in the pool.</em>
<a name="545" href="#545">545</a> <em>     *                Use a negative value to indicate an unlimited number</em>
<a name="546" href="#546">546</a> <em>     *                of idle instances.</em>
<a name="547" href="#547">547</a> <em>     * @see #getMaxIdle</em>
<a name="548" href="#548">548</a> <em>     */</em>
<a name="549" href="#549">549</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setMaxIdle(<strong>int</strong> maxIdle) {
<a name="550" href="#550">550</a>         _maxIdle = maxIdle;
<a name="551" href="#551">551</a>         notifyAll();
<a name="552" href="#552">552</a>     }
<a name="553" href="#553">553</a> 
<a name="554" href="#554">554</a>     <em>/**<em>*</em></em>
<a name="555" href="#555">555</a> <em>     * Sets the minimum number of objects allowed in the pool</em>
<a name="556" href="#556">556</a> <em>     * before the evictor thread (if active) spawns new objects.</em>
<a name="557" href="#557">557</a> <em>     * (Note no objects are created when: numActive + numIdle >= maxActive)</em>
<a name="558" href="#558">558</a> <em>     *</em>
<a name="559" href="#559">559</a> <em>     * @param minIdle The minimum number of objects.</em>
<a name="560" href="#560">560</a> <em>     * @see #getMinIdle</em>
<a name="561" href="#561">561</a> <em>     */</em>
<a name="562" href="#562">562</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setMinIdle(<strong>int</strong> minIdle) {
<a name="563" href="#563">563</a>         _minIdle = minIdle;
<a name="564" href="#564">564</a>         notifyAll();
<a name="565" href="#565">565</a>     }
<a name="566" href="#566">566</a> 
<a name="567" href="#567">567</a>     <em>/**<em>*</em></em>
<a name="568" href="#568">568</a> <em>     * Returns the minimum number of objects allowed in the pool</em>
<a name="569" href="#569">569</a> <em>     * before the evictor thread (if active) spawns new objects.</em>
<a name="570" href="#570">570</a> <em>     * (Note no objects are created when: numActive + numIdle >= maxActive)</em>
<a name="571" href="#571">571</a> <em>     *</em>
<a name="572" href="#572">572</a> <em>     * @return The minimum number of objects.</em>
<a name="573" href="#573">573</a> <em>     * @see #setMinIdle</em>
<a name="574" href="#574">574</a> <em>     */</em>
<a name="575" href="#575">575</a>     <strong>public</strong> <strong>synchronized</strong> <strong>int</strong> getMinIdle() {
<a name="576" href="#576">576</a>         <strong>return</strong> _minIdle;
<a name="577" href="#577">577</a>     }
<a name="578" href="#578">578</a> 
<a name="579" href="#579">579</a>     <em>/**<em>*</em></em>
<a name="580" href="#580">580</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="581" href="#581">581</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="582" href="#582">582</a> <em>     * before being returned by the {@link #borrowObject}</em>
<a name="583" href="#583">583</a> <em>     * method.  If the object fails to validate,</em>
<a name="584" href="#584">584</a> <em>     * it will be dropped from the pool, and we will attempt</em>
<a name="585" href="#585">585</a> <em>     * to borrow another.</em>
<a name="586" href="#586">586</a> <em>     *</em>
<a name="587" href="#587">587</a> <em>     * @see #setTestOnBorrow</em>
<a name="588" href="#588">588</a> <em>     */</em>
<a name="589" href="#589">589</a>     <strong>public</strong> <strong>synchronized</strong> <strong>boolean</strong> getTestOnBorrow() {
<a name="590" href="#590">590</a>         <strong>return</strong> _testOnBorrow;
<a name="591" href="#591">591</a>     }
<a name="592" href="#592">592</a> 
<a name="593" href="#593">593</a>     <em>/**<em>*</em></em>
<a name="594" href="#594">594</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="595" href="#595">595</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="596" href="#596">596</a> <em>     * before being returned by the {@link #borrowObject}</em>
<a name="597" href="#597">597</a> <em>     * method.  If the object fails to validate,</em>
<a name="598" href="#598">598</a> <em>     * it will be dropped from the pool, and we will attempt</em>
<a name="599" href="#599">599</a> <em>     * to borrow another.</em>
<a name="600" href="#600">600</a> <em>     *</em>
<a name="601" href="#601">601</a> <em>     * @see #getTestOnBorrow</em>
<a name="602" href="#602">602</a> <em>     */</em>
<a name="603" href="#603">603</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setTestOnBorrow(<strong>boolean</strong> testOnBorrow) {
<a name="604" href="#604">604</a>         _testOnBorrow = testOnBorrow;
<a name="605" href="#605">605</a>     }
<a name="606" href="#606">606</a> 
<a name="607" href="#607">607</a>     <em>/**<em>*</em></em>
<a name="608" href="#608">608</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="609" href="#609">609</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="610" href="#610">610</a> <em>     * before being returned to the pool within the</em>
<a name="611" href="#611">611</a> <em>     * {@link #returnObject}.</em>
<a name="612" href="#612">612</a> <em>     *</em>
<a name="613" href="#613">613</a> <em>     * @see #setTestOnReturn</em>
<a name="614" href="#614">614</a> <em>     */</em>
<a name="615" href="#615">615</a>     <strong>public</strong> <strong>synchronized</strong> <strong>boolean</strong> getTestOnReturn() {
<a name="616" href="#616">616</a>         <strong>return</strong> _testOnReturn;
<a name="617" href="#617">617</a>     }
<a name="618" href="#618">618</a> 
<a name="619" href="#619">619</a>     <em>/**<em>*</em></em>
<a name="620" href="#620">620</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="621" href="#621">621</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="622" href="#622">622</a> <em>     * before being returned to the pool within the</em>
<a name="623" href="#623">623</a> <em>     * {@link #returnObject}.</em>
<a name="624" href="#624">624</a> <em>     *</em>
<a name="625" href="#625">625</a> <em>     * @see #getTestOnReturn</em>
<a name="626" href="#626">626</a> <em>     */</em>
<a name="627" href="#627">627</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setTestOnReturn(<strong>boolean</strong> testOnReturn) {
<a name="628" href="#628">628</a>         _testOnReturn = testOnReturn;
<a name="629" href="#629">629</a>     }
<a name="630" href="#630">630</a> 
<a name="631" href="#631">631</a>     <em>/**<em>*</em></em>
<a name="632" href="#632">632</a> <em>     * Returns the number of milliseconds to sleep between runs of the</em>
<a name="633" href="#633">633</a> <em>     * idle object evictor thread.</em>
<a name="634" href="#634">634</a> <em>     * When non-positive, no idle object evictor thread will be</em>
<a name="635" href="#635">635</a> <em>     * run.</em>
<a name="636" href="#636">636</a> <em>     *</em>
<a name="637" href="#637">637</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="638" href="#638">638</a> <em>     */</em>
<a name="639" href="#639">639</a>     <strong>public</strong> <strong>synchronized</strong> <strong>long</strong> getTimeBetweenEvictionRunsMillis() {
<a name="640" href="#640">640</a>         <strong>return</strong> _timeBetweenEvictionRunsMillis;
<a name="641" href="#641">641</a>     }
<a name="642" href="#642">642</a> 
<a name="643" href="#643">643</a>     <em>/**<em>*</em></em>
<a name="644" href="#644">644</a> <em>     * Sets the number of milliseconds to sleep between runs of the</em>
<a name="645" href="#645">645</a> <em>     * idle object evictor thread.</em>
<a name="646" href="#646">646</a> <em>     * When non-positive, no idle object evictor thread will be</em>
<a name="647" href="#647">647</a> <em>     * run.</em>
<a name="648" href="#648">648</a> <em>     *</em>
<a name="649" href="#649">649</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="650" href="#650">650</a> <em>     */</em>
<a name="651" href="#651">651</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setTimeBetweenEvictionRunsMillis(<strong>long</strong> timeBetweenEvictionRunsMillis) {
<a name="652" href="#652">652</a>         _timeBetweenEvictionRunsMillis = timeBetweenEvictionRunsMillis;
<a name="653" href="#653">653</a>         startEvictor(_timeBetweenEvictionRunsMillis);
<a name="654" href="#654">654</a>     }
<a name="655" href="#655">655</a> 
<a name="656" href="#656">656</a>     <em>/**<em>*</em></em>
<a name="657" href="#657">657</a> <em>     * Returns the max number of objects to examine during each run of the</em>
<a name="658" href="#658">658</a> <em>     * idle object evictor thread (if any).</em>
<a name="659" href="#659">659</a> <em>     *</em>
<a name="660" href="#660">660</a> <em>     * @see #setNumTestsPerEvictionRun</em>
<a name="661" href="#661">661</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="662" href="#662">662</a> <em>     */</em>
<a name="663" href="#663">663</a>     <strong>public</strong> <strong>synchronized</strong> <strong>int</strong> getNumTestsPerEvictionRun() {
<a name="664" href="#664">664</a>         <strong>return</strong> _numTestsPerEvictionRun;
<a name="665" href="#665">665</a>     }
<a name="666" href="#666">666</a> 
<a name="667" href="#667">667</a>     <em>/**<em>*</em></em>
<a name="668" href="#668">668</a> <em>     * Sets the max number of objects to examine during each run of the</em>
<a name="669" href="#669">669</a> <em>     * idle object evictor thread (if any).</em>
<a name="670" href="#670">670</a> <em>     * &lt;p></em>
<a name="671" href="#671">671</a> <em>     * When a negative value is supplied, &lt;tt>ceil({@link #getNumIdle})/abs({@link #getNumTestsPerEvictionRun})&lt;/tt></em>
<a name="672" href="#672">672</a> <em>     * tests will be run.  I.e., when the value is &lt;i>-n&lt;/i>, roughly one &lt;i>n&lt;/i>th of the</em>
<a name="673" href="#673">673</a> <em>     * idle objects will be tested per run.</em>
<a name="674" href="#674">674</a> <em>     *</em>
<a name="675" href="#675">675</a> <em>     * @see #getNumTestsPerEvictionRun</em>
<a name="676" href="#676">676</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="677" href="#677">677</a> <em>     */</em>
<a name="678" href="#678">678</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setNumTestsPerEvictionRun(<strong>int</strong> numTestsPerEvictionRun) {
<a name="679" href="#679">679</a>         _numTestsPerEvictionRun = numTestsPerEvictionRun;
<a name="680" href="#680">680</a>     }
<a name="681" href="#681">681</a> 
<a name="682" href="#682">682</a>     <em>/**<em>*</em></em>
<a name="683" href="#683">683</a> <em>     * Returns the minimum amount of time an object may sit idle in the pool</em>
<a name="684" href="#684">684</a> <em>     * before it is eligable for eviction by the idle object evictor</em>
<a name="685" href="#685">685</a> <em>     * (if any).</em>
<a name="686" href="#686">686</a> <em>     *</em>
<a name="687" href="#687">687</a> <em>     * @see #setMinEvictableIdleTimeMillis</em>
<a name="688" href="#688">688</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="689" href="#689">689</a> <em>     */</em>
<a name="690" href="#690">690</a>     <strong>public</strong> <strong>synchronized</strong> <strong>long</strong> getMinEvictableIdleTimeMillis() {
<a name="691" href="#691">691</a>         <strong>return</strong> _minEvictableIdleTimeMillis;
<a name="692" href="#692">692</a>     }
<a name="693" href="#693">693</a> 
<a name="694" href="#694">694</a>     <em>/**<em>*</em></em>
<a name="695" href="#695">695</a> <em>     * Sets the minimum amount of time an object may sit idle in the pool</em>
<a name="696" href="#696">696</a> <em>     * before it is eligable for eviction by the idle object evictor</em>
<a name="697" href="#697">697</a> <em>     * (if any).</em>
<a name="698" href="#698">698</a> <em>     * When non-positive, no objects will be evicted from the pool</em>
<a name="699" href="#699">699</a> <em>     * due to idle time alone.</em>
<a name="700" href="#700">700</a> <em>     *</em>
<a name="701" href="#701">701</a> <em>     * @see #getMinEvictableIdleTimeMillis</em>
<a name="702" href="#702">702</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="703" href="#703">703</a> <em>     */</em>
<a name="704" href="#704">704</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setMinEvictableIdleTimeMillis(<strong>long</strong> minEvictableIdleTimeMillis) {
<a name="705" href="#705">705</a>         _minEvictableIdleTimeMillis = minEvictableIdleTimeMillis;
<a name="706" href="#706">706</a>     }
<a name="707" href="#707">707</a> 
<a name="708" href="#708">708</a>     <em>/**<em>*</em></em>
<a name="709" href="#709">709</a> <em>     * Returns the minimum amount of time an object may sit idle in the pool</em>
<a name="710" href="#710">710</a> <em>     * before it is eligable for eviction by the idle object evictor</em>
<a name="711" href="#711">711</a> <em>     * (if any), with the extra condition that at least</em>
<a name="712" href="#712">712</a> <em>     * "minIdle" amount of object remain in the pool.</em>
<a name="713" href="#713">713</a> <em>     *</em>
<a name="714" href="#714">714</a> <em>     * @see #setSoftMinEvictableIdleTimeMillis</em>
<a name="715" href="#715">715</a> <em>     */</em>
<a name="716" href="#716">716</a>     <strong>public</strong> <strong>synchronized</strong> <strong>long</strong> getSoftMinEvictableIdleTimeMillis() {
<a name="717" href="#717">717</a>         <strong>return</strong> _softMinEvictableIdleTimeMillis;
<a name="718" href="#718">718</a>     }
<a name="719" href="#719">719</a> 
<a name="720" href="#720">720</a>     <em>/**<em>*</em></em>
<a name="721" href="#721">721</a> <em>     * Sets the minimum amount of time an object may sit idle in the pool</em>
<a name="722" href="#722">722</a> <em>     * before it is eligable for eviction by the idle object evictor</em>
<a name="723" href="#723">723</a> <em>     * (if any), with the extra condition that at least</em>
<a name="724" href="#724">724</a> <em>     * "minIdle" amount of object remain in the pool.</em>
<a name="725" href="#725">725</a> <em>     * When non-positive, no objects will be evicted from the pool</em>
<a name="726" href="#726">726</a> <em>     * due to idle time alone.</em>
<a name="727" href="#727">727</a> <em>     *</em>
<a name="728" href="#728">728</a> <em>     * @see #getSoftMinEvictableIdleTimeMillis</em>
<a name="729" href="#729">729</a> <em>     */</em>
<a name="730" href="#730">730</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setSoftMinEvictableIdleTimeMillis(<strong>long</strong> softMinEvictableIdleTimeMillis) {
<a name="731" href="#731">731</a>         _softMinEvictableIdleTimeMillis = softMinEvictableIdleTimeMillis;
<a name="732" href="#732">732</a>     }
<a name="733" href="#733">733</a> 
<a name="734" href="#734">734</a>     <em>/**<em>*</em></em>
<a name="735" href="#735">735</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="736" href="#736">736</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="737" href="#737">737</a> <em>     * by the idle object evictor (if any).  If an object</em>
<a name="738" href="#738">738</a> <em>     * fails to validate, it will be dropped from the pool.</em>
<a name="739" href="#739">739</a> <em>     *</em>
<a name="740" href="#740">740</a> <em>     * @see #setTestWhileIdle</em>
<a name="741" href="#741">741</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="742" href="#742">742</a> <em>     */</em>
<a name="743" href="#743">743</a>     <strong>public</strong> <strong>synchronized</strong> <strong>boolean</strong> getTestWhileIdle() {
<a name="744" href="#744">744</a>         <strong>return</strong> _testWhileIdle;
<a name="745" href="#745">745</a>     }
<a name="746" href="#746">746</a> 
<a name="747" href="#747">747</a>     <em>/**<em>*</em></em>
<a name="748" href="#748">748</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="749" href="#749">749</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="750" href="#750">750</a> <em>     * by the idle object evictor (if any).  If an object</em>
<a name="751" href="#751">751</a> <em>     * fails to validate, it will be dropped from the pool.</em>
<a name="752" href="#752">752</a> <em>     *</em>
<a name="753" href="#753">753</a> <em>     * @see #getTestWhileIdle</em>
<a name="754" href="#754">754</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="755" href="#755">755</a> <em>     */</em>
<a name="756" href="#756">756</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setTestWhileIdle(<strong>boolean</strong> testWhileIdle) {
<a name="757" href="#757">757</a>         _testWhileIdle = testWhileIdle;
<a name="758" href="#758">758</a>     }
<a name="759" href="#759">759</a> 
<a name="760" href="#760">760</a>     <em>/**<em>*</em></em>
<a name="761" href="#761">761</a> <em>     * Sets my configuration.</em>
<a name="762" href="#762">762</a> <em>     * @see GenericObjectPool.Config</em>
<a name="763" href="#763">763</a> <em>     */</em>
<a name="764" href="#764">764</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setConfig(GenericObjectPool.Config conf) {
<a name="765" href="#765">765</a>         setMaxIdle(conf.maxIdle);
<a name="766" href="#766">766</a>         setMinIdle(conf.minIdle);
<a name="767" href="#767">767</a>         setMaxActive(conf.maxActive);
<a name="768" href="#768">768</a>         setMaxWait(conf.maxWait);
<a name="769" href="#769">769</a>         setWhenExhaustedAction(conf.whenExhaustedAction);
<a name="770" href="#770">770</a>         setTestOnBorrow(conf.testOnBorrow);
<a name="771" href="#771">771</a>         setTestOnReturn(conf.testOnReturn);
<a name="772" href="#772">772</a>         setTestWhileIdle(conf.testWhileIdle);
<a name="773" href="#773">773</a>         setNumTestsPerEvictionRun(conf.numTestsPerEvictionRun);
<a name="774" href="#774">774</a>         setMinEvictableIdleTimeMillis(conf.minEvictableIdleTimeMillis);
<a name="775" href="#775">775</a>         setTimeBetweenEvictionRunsMillis(conf.timeBetweenEvictionRunsMillis);
<a name="776" href="#776">776</a>         notifyAll();
<a name="777" href="#777">777</a>     }
<a name="778" href="#778">778</a> 
<a name="779" href="#779">779</a>     <em class="comment">//-- ObjectPool methods ------------------------------------------</em>
<a name="780" href="#780">780</a> 
<a name="781" href="#781">781</a>     <strong>public</strong> <strong>synchronized</strong> Object borrowObject() throws Exception {
<a name="782" href="#782">782</a>         assertOpen();
<a name="783" href="#783">783</a>         <strong>long</strong> starttime = System.currentTimeMillis();
<a name="784" href="#784">784</a>         <strong>for</strong>(;;) {
<a name="785" href="#785">785</a>             ObjectTimestampPair pair = <strong>null</strong>;
<a name="786" href="#786">786</a> 
<a name="787" href="#787">787</a>             <em class="comment">// if there are any sleeping, just grab one of those</em>
<a name="788" href="#788">788</a>             <strong>try</strong> {
<a name="789" href="#789">789</a>                 pair = (ObjectTimestampPair)(_pool.removeFirst());
<a name="790" href="#790">790</a>             } <strong>catch</strong>(NoSuchElementException e) {
<a name="791" href="#791">791</a>                 ; <em class="comment">/*<em class="comment"> ignored */</em></em>
<a name="792" href="#792">792</a>             }
<a name="793" href="#793">793</a> 
<a name="794" href="#794">794</a>             <em class="comment">// otherwise</em>
<a name="795" href="#795">795</a>             <strong>if</strong>(<strong>null</strong> == pair) {
<a name="796" href="#796">796</a>                 <em class="comment">// check if we can create one</em>
<a name="797" href="#797">797</a>                 <em class="comment">// (note we know that the num sleeping is 0, else we wouldn't be here)</em>
<a name="798" href="#798">798</a>                 <strong>if</strong>(_maxActive &lt; 0 || _numActive &lt; _maxActive) {
<a name="799" href="#799">799</a>                     <em class="comment">// allow new object to be created</em>
<a name="800" href="#800">800</a>                 } <strong>else</strong> {
<a name="801" href="#801">801</a>                     <em class="comment">// the pool is exhausted</em>
<a name="802" href="#802">802</a>                     <strong>switch</strong>(_whenExhaustedAction) {
<a name="803" href="#803">803</a>                         <strong>case</strong> WHEN_EXHAUSTED_GROW:
<a name="804" href="#804">804</a>                             <em class="comment">// allow new object to be created</em>
<a name="805" href="#805">805</a>                             <strong>break</strong>;
<a name="806" href="#806">806</a>                         <strong>case</strong> WHEN_EXHAUSTED_FAIL:
<a name="807" href="#807">807</a>                             <strong>throw</strong> <strong>new</strong> NoSuchElementException(<span class="string">"Pool exhausted"</span>);
<a name="808" href="#808">808</a>                         <strong>case</strong> WHEN_EXHAUSTED_BLOCK:
<a name="809" href="#809">809</a>                             <strong>try</strong> {
<a name="810" href="#810">810</a>                                 <strong>if</strong>(_maxWait &lt;= 0) {
<a name="811" href="#811">811</a>                                     wait();
<a name="812" href="#812">812</a>                                 } <strong>else</strong> {
<a name="813" href="#813">813</a>                                     <em class="comment">// this code may be executed again after a notify then continue cycle</em>
<a name="814" href="#814">814</a>                                     <em class="comment">// so, need to calculate the amount of time to wait</em>
<a name="815" href="#815">815</a>                                     <strong>final</strong> <strong>long</strong> elapsed = (System.currentTimeMillis() - starttime);
<a name="816" href="#816">816</a>                                     <strong>final</strong> <strong>long</strong> waitTime = _maxWait - elapsed;
<a name="817" href="#817">817</a>                                     <strong>if</strong> (waitTime > 0)
<a name="818" href="#818">818</a>                                     {
<a name="819" href="#819">819</a>                                         wait(waitTime);
<a name="820" href="#820">820</a>                                     }
<a name="821" href="#821">821</a>                                 }
<a name="822" href="#822">822</a>                             } <strong>catch</strong>(InterruptedException e) {
<a name="823" href="#823">823</a>                                 <em class="comment">// ignored</em>
<a name="824" href="#824">824</a>                             }
<a name="825" href="#825">825</a>                             <strong>if</strong>(_maxWait > 0 &amp;&amp; ((System.currentTimeMillis() - starttime) >= _maxWait)) {
<a name="826" href="#826">826</a>                                 <strong>throw</strong> <strong>new</strong> NoSuchElementException(<span class="string">"Timeout waiting for idle object"</span>);
<a name="827" href="#827">827</a>                             } <strong>else</strong> {
<a name="828" href="#828">828</a>                                 <strong>continue</strong>; <em class="comment">// keep looping</em>
<a name="829" href="#829">829</a>                             }
<a name="830" href="#830">830</a>                         <strong>default</strong>:
<a name="831" href="#831">831</a>                             <strong>throw</strong> <strong>new</strong> IllegalArgumentException(<span class="string">"WhenExhaustedAction property "</span> + _whenExhaustedAction + <span class="string">" not recognized."</span>);
<a name="832" href="#832">832</a>                     }
<a name="833" href="#833">833</a>                 }
<a name="834" href="#834">834</a>             }
<a name="835" href="#835">835</a>             _numActive++;
<a name="836" href="#836">836</a> 
<a name="837" href="#837">837</a>             <em class="comment">// create new object when needed</em>
<a name="838" href="#838">838</a>             <strong>boolean</strong> newlyCreated = false;
<a name="839" href="#839">839</a>             <strong>if</strong>(<strong>null</strong> == pair) {
<a name="840" href="#840">840</a>                 <strong>try</strong> {
<a name="841" href="#841">841</a>                     Object obj = _factory.makeObject();
<a name="842" href="#842">842</a>                     pair = <strong>new</strong> ObjectTimestampPair(obj);
<a name="843" href="#843">843</a>                     newlyCreated = <strong>true</strong>;
<a name="844" href="#844">844</a>                 } <strong>finally</strong> {
<a name="845" href="#845">845</a>                     <strong>if</strong> (!newlyCreated) {
<a name="846" href="#846">846</a>                         <em class="comment">// object cannot be created</em>
<a name="847" href="#847">847</a>                         _numActive--;
<a name="848" href="#848">848</a>                         notifyAll();
<a name="849" href="#849">849</a>                     }
<a name="850" href="#850">850</a>                 }
<a name="851" href="#851">851</a>             }
<a name="852" href="#852">852</a> 
<a name="853" href="#853">853</a>             <em class="comment">// activate &amp; validate the object</em>
<a name="854" href="#854">854</a>             <strong>try</strong> {
<a name="855" href="#855">855</a>                 _factory.activateObject(pair.value);
<a name="856" href="#856">856</a>                 <strong>if</strong>(_testOnBorrow &amp;&amp; !_factory.validateObject(pair.value)) {
<a name="857" href="#857">857</a>                     <strong>throw</strong> <strong>new</strong> Exception(<span class="string">"ValidateObject failed"</span>);
<a name="858" href="#858">858</a>                 }
<a name="859" href="#859">859</a>                 <strong>return</strong> pair.value;
<a name="860" href="#860">860</a>             }
<a name="861" href="#861">861</a>             <strong>catch</strong> (Throwable e) {
<a name="862" href="#862">862</a>                 <em class="comment">// object cannot be activated or is invalid</em>
<a name="863" href="#863">863</a>                 _numActive--;
<a name="864" href="#864">864</a>                 notifyAll();
<a name="865" href="#865">865</a>                 <strong>try</strong> {
<a name="866" href="#866">866</a>                     _factory.destroyObject(pair.value);
<a name="867" href="#867">867</a>                 }
<a name="868" href="#868">868</a>                 <strong>catch</strong> (Throwable e2) {
<a name="869" href="#869">869</a>                     <em class="comment">// cannot destroy broken object</em>
<a name="870" href="#870">870</a>                 }
<a name="871" href="#871">871</a>                 <strong>if</strong>(newlyCreated) {
<a name="872" href="#872">872</a>                     <strong>throw</strong> <strong>new</strong> NoSuchElementException(<span class="string">"Could not create a validated object, cause: "</span> + e.getMessage());
<a name="873" href="#873">873</a>                 }
<a name="874" href="#874">874</a>                 <strong>else</strong> {
<a name="875" href="#875">875</a>                     <strong>continue</strong>; <em class="comment">// keep looping</em>
<a name="876" href="#876">876</a>                 }
<a name="877" href="#877">877</a>             }
<a name="878" href="#878">878</a>         }
<a name="879" href="#879">879</a>     }
<a name="880" href="#880">880</a> 
<a name="881" href="#881">881</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> invalidateObject(Object obj) throws Exception {
<a name="882" href="#882">882</a>         assertOpen();
<a name="883" href="#883">883</a>         <strong>try</strong> {
<a name="884" href="#884">884</a>             _factory.destroyObject(obj);
<a name="885" href="#885">885</a>         }
<a name="886" href="#886">886</a>         <strong>finally</strong> {
<a name="887" href="#887">887</a>             _numActive--;
<a name="888" href="#888">888</a>             notifyAll(); <em class="comment">// _numActive has changed</em>
<a name="889" href="#889">889</a>         }
<a name="890" href="#890">890</a>     }
<a name="891" href="#891">891</a> 
<a name="892" href="#892">892</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> clear() {
<a name="893" href="#893">893</a>         assertOpen();
<a name="894" href="#894">894</a>         <strong>for</strong>(Iterator it = _pool.iterator(); it.hasNext(); ) {
<a name="895" href="#895">895</a>             <strong>try</strong> {
<a name="896" href="#896">896</a>                 _factory.destroyObject(((ObjectTimestampPair)(it.next())).value);
<a name="897" href="#897">897</a>             } <strong>catch</strong>(Exception e) {
<a name="898" href="#898">898</a>                 <em class="comment">// ignore error, keep destroying the rest</em>
<a name="899" href="#899">899</a>             }
<a name="900" href="#900">900</a>             it.remove();
<a name="901" href="#901">901</a>         }
<a name="902" href="#902">902</a>         _pool.clear();
<a name="903" href="#903">903</a>         notifyAll(); <em class="comment">// num sleeping has changed</em>
<a name="904" href="#904">904</a>     }
<a name="905" href="#905">905</a> 
<a name="906" href="#906">906</a>     <strong>public</strong> <strong>synchronized</strong> <strong>int</strong> getNumActive() {
<a name="907" href="#907">907</a>         assertOpen();
<a name="908" href="#908">908</a>         <strong>return</strong> _numActive;
<a name="909" href="#909">909</a>     }
<a name="910" href="#910">910</a> 
<a name="911" href="#911">911</a>     <strong>public</strong> <strong>synchronized</strong> <strong>int</strong> getNumIdle() {
<a name="912" href="#912">912</a>         assertOpen();
<a name="913" href="#913">913</a>         <strong>return</strong> _pool.size();
<a name="914" href="#914">914</a>     }
<a name="915" href="#915">915</a> 
<a name="916" href="#916">916</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> returnObject(Object obj) throws Exception {
<a name="917" href="#917">917</a>         assertOpen();
<a name="918" href="#918">918</a>         addObjectToPool(obj, <strong>true</strong>);
<a name="919" href="#919">919</a>     }
<a name="920" href="#920">920</a> 
<a name="921" href="#921">921</a>     <strong>private</strong> <strong>void</strong> addObjectToPool(Object obj, <strong>boolean</strong> decrementNumActive) throws Exception {
<a name="922" href="#922">922</a>         <strong>boolean</strong> success = <strong>true</strong>;
<a name="923" href="#923">923</a>         <strong>if</strong>(_testOnReturn &amp;&amp; !(_factory.validateObject(obj))) {
<a name="924" href="#924">924</a>             success = false;
<a name="925" href="#925">925</a>         } <strong>else</strong> {
<a name="926" href="#926">926</a>             <strong>try</strong> {
<a name="927" href="#927">927</a>                 _factory.passivateObject(obj);
<a name="928" href="#928">928</a>             } <strong>catch</strong>(Exception e) {
<a name="929" href="#929">929</a>                 success = false;
<a name="930" href="#930">930</a>             }
<a name="931" href="#931">931</a>         }
<a name="932" href="#932">932</a> 
<a name="933" href="#933">933</a>         <strong>boolean</strong> shouldDestroy = !success;
<a name="934" href="#934">934</a> 
<a name="935" href="#935">935</a>         <strong>if</strong> (decrementNumActive) {
<a name="936" href="#936">936</a>             _numActive--;
<a name="937" href="#937">937</a>         }
<a name="938" href="#938">938</a>         <strong>if</strong>((_maxIdle >= 0) &amp;&amp; (_pool.size() >= _maxIdle)) {
<a name="939" href="#939">939</a>             shouldDestroy = <strong>true</strong>;
<a name="940" href="#940">940</a>         } <strong>else</strong> <strong>if</strong>(success) {
<a name="941" href="#941">941</a>             _pool.addLast(<strong>new</strong> ObjectTimestampPair(obj));
<a name="942" href="#942">942</a>         }
<a name="943" href="#943">943</a>         notifyAll(); <em class="comment">// _numActive has changed</em>
<a name="944" href="#944">944</a> 
<a name="945" href="#945">945</a>         <strong>if</strong>(shouldDestroy) {
<a name="946" href="#946">946</a>             <strong>try</strong> {
<a name="947" href="#947">947</a>                 _factory.destroyObject(obj);
<a name="948" href="#948">948</a>             } <strong>catch</strong>(Exception e) {
<a name="949" href="#949">949</a>                 <em class="comment">// ignored</em>
<a name="950" href="#950">950</a>             }
<a name="951" href="#951">951</a>         }
<a name="952" href="#952">952</a>     }
<a name="953" href="#953">953</a> 
<a name="954" href="#954">954</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> close() throws Exception {
<a name="955" href="#955">955</a>         clear();
<a name="956" href="#956">956</a>         _pool = <strong>null</strong>;
<a name="957" href="#957">957</a>         _factory = <strong>null</strong>;
<a name="958" href="#958">958</a>         startEvictor(-1L);
<a name="959" href="#959">959</a>         <strong>super</strong>.close();
<a name="960" href="#960">960</a>     }
<a name="961" href="#961">961</a> 
<a name="962" href="#962">962</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> setFactory(PoolableObjectFactory factory) throws IllegalStateException {
<a name="963" href="#963">963</a>         assertOpen();
<a name="964" href="#964">964</a>         <strong>if</strong>(0 &lt; getNumActive()) {
<a name="965" href="#965">965</a>             <strong>throw</strong> <strong>new</strong> IllegalStateException(<span class="string">"Objects are already active"</span>);
<a name="966" href="#966">966</a>         } <strong>else</strong> {
<a name="967" href="#967">967</a>             clear();
<a name="968" href="#968">968</a>             _factory = factory;
<a name="969" href="#969">969</a>         }
<a name="970" href="#970">970</a>     }
<a name="971" href="#971">971</a> 
<a name="972" href="#972">972</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> evict() throws Exception {
<a name="973" href="#973">973</a>         assertOpen();
<a name="974" href="#974">974</a>         <strong>if</strong>(!_pool.isEmpty()) {
<a name="975" href="#975">975</a>             ListIterator iter;
<a name="976" href="#976">976</a>             <strong>if</strong> (evictLastIndex &lt; 0) {
<a name="977" href="#977">977</a>                 iter = _pool.listIterator(_pool.size());
<a name="978" href="#978">978</a>             } <strong>else</strong> {
<a name="979" href="#979">979</a>                 iter = _pool.listIterator(evictLastIndex);
<a name="980" href="#980">980</a>             }
<a name="981" href="#981">981</a>             <strong>for</strong>(<strong>int</strong> i=0,m=getNumTests();i&lt;m;i++) {
<a name="982" href="#982">982</a>                 <strong>if</strong>(!iter.hasPrevious()) {
<a name="983" href="#983">983</a>                     iter = _pool.listIterator(_pool.size());
<a name="984" href="#984">984</a>                 }
<a name="985" href="#985">985</a>                 <strong>boolean</strong> removeObject = false;
<a name="986" href="#986">986</a>                 <strong>final</strong> ObjectTimestampPair pair = (ObjectTimestampPair)(iter.previous());
<a name="987" href="#987">987</a>                 <strong>final</strong> <strong>long</strong> idleTimeMilis = System.currentTimeMillis() - pair.tstamp;
<a name="988" href="#988">988</a>                 <strong>if</strong> ((_minEvictableIdleTimeMillis > 0)
<a name="989" href="#989">989</a>                         &amp;&amp; (idleTimeMilis > _minEvictableIdleTimeMillis)) {
<a name="990" href="#990">990</a>                     removeObject = <strong>true</strong>;
<a name="991" href="#991">991</a>                 } <strong>else</strong> <strong>if</strong> ((_softMinEvictableIdleTimeMillis > 0)
<a name="992" href="#992">992</a>                         &amp;&amp; (idleTimeMilis > _softMinEvictableIdleTimeMillis)
<a name="993" href="#993">993</a>                         &amp;&amp; (getNumIdle() > getMinIdle())) {
<a name="994" href="#994">994</a>                     removeObject = <strong>true</strong>;
<a name="995" href="#995">995</a>                 }
<a name="996" href="#996">996</a>                 <strong>if</strong>(_testWhileIdle &amp;&amp; !removeObject) {
<a name="997" href="#997">997</a>                     <strong>boolean</strong> active = false;
<a name="998" href="#998">998</a>                     <strong>try</strong> {
<a name="999" href="#999">999</a>                         _factory.activateObject(pair.value);
<a name="1000" href="#1000">1000</a>                         active = <strong>true</strong>;
<a name="1001" href="#1001">1001</a>                     } <strong>catch</strong>(Exception e) {
<a name="1002" href="#1002">1002</a>                         removeObject=<strong>true</strong>;
<a name="1003" href="#1003">1003</a>                     }
<a name="1004" href="#1004">1004</a>                     <strong>if</strong>(active) {
<a name="1005" href="#1005">1005</a>                         <strong>if</strong>(!_factory.validateObject(pair.value)) {
<a name="1006" href="#1006">1006</a>                             removeObject=<strong>true</strong>;
<a name="1007" href="#1007">1007</a>                         } <strong>else</strong> {
<a name="1008" href="#1008">1008</a>                             <strong>try</strong> {
<a name="1009" href="#1009">1009</a>                                 _factory.passivateObject(pair.value);
<a name="1010" href="#1010">1010</a>                             } <strong>catch</strong>(Exception e) {
<a name="1011" href="#1011">1011</a>                                 removeObject=<strong>true</strong>;
<a name="1012" href="#1012">1012</a>                             }
<a name="1013" href="#1013">1013</a>                         }
<a name="1014" href="#1014">1014</a>                     }
<a name="1015" href="#1015">1015</a>                 }
<a name="1016" href="#1016">1016</a>                 <strong>if</strong>(removeObject) {
<a name="1017" href="#1017">1017</a>                     <strong>try</strong> {
<a name="1018" href="#1018">1018</a>                         iter.remove();
<a name="1019" href="#1019">1019</a>                         _factory.destroyObject(pair.value);
<a name="1020" href="#1020">1020</a>                     } <strong>catch</strong>(Exception e) {
<a name="1021" href="#1021">1021</a>                         <em class="comment">// ignored</em>
<a name="1022" href="#1022">1022</a>                     }
<a name="1023" href="#1023">1023</a>                 }
<a name="1024" href="#1024">1024</a>             }
<a name="1025" href="#1025">1025</a>             evictLastIndex = iter.previousIndex(); <em class="comment">// resume from here</em>
<a name="1026" href="#1026">1026</a>         } <em class="comment">// if !empty</em>
<a name="1027" href="#1027">1027</a>     }
<a name="1028" href="#1028">1028</a> 
<a name="1029" href="#1029">1029</a>     <em>/**<em>*</em></em>
<a name="1030" href="#1030">1030</a> <em>     * Check to see if we are below our minimum number of objects</em>
<a name="1031" href="#1031">1031</a> <em>     * if so enough to bring us back to our minimum.</em>
<a name="1032" href="#1032">1032</a> <em>     */</em>
<a name="1033" href="#1033">1033</a>     <strong>private</strong> <strong>void</strong> ensureMinIdle() throws Exception {
<a name="1034" href="#1034">1034</a>         <em class="comment">// this method isn't synchronized so the</em>
<a name="1035" href="#1035">1035</a>         <em class="comment">// calculateDeficit is done at the beginning</em>
<a name="1036" href="#1036">1036</a>         <em class="comment">// as a loop limit and a second time inside the loop</em>
<a name="1037" href="#1037">1037</a>         <em class="comment">// to stop when another thread already returned the</em>
<a name="1038" href="#1038">1038</a>         <em class="comment">// needed objects</em>
<a name="1039" href="#1039">1039</a>         <strong>int</strong> objectDeficit = calculateDeficit();
<a name="1040" href="#1040">1040</a>         <strong>for</strong> ( <strong>int</strong> j = 0 ; j &lt; objectDeficit &amp;&amp; calculateDeficit() > 0 ; j++ ) {
<a name="1041" href="#1041">1041</a>             addObject();
<a name="1042" href="#1042">1042</a>         }
<a name="1043" href="#1043">1043</a>     }
<a name="1044" href="#1044">1044</a> 
<a name="1045" href="#1045">1045</a>     <strong>private</strong> <strong>synchronized</strong> <strong>int</strong> calculateDeficit() {
<a name="1046" href="#1046">1046</a>         <strong>int</strong> objectDeficit = getMinIdle() - getNumIdle();
<a name="1047" href="#1047">1047</a>         <strong>if</strong> (_maxActive > 0) {
<a name="1048" href="#1048">1048</a>             <strong>int</strong> growLimit = Math.max(0, getMaxActive() - getNumActive() - getNumIdle());
<a name="1049" href="#1049">1049</a>             objectDeficit = Math.min(objectDeficit, growLimit);
<a name="1050" href="#1050">1050</a>         }
<a name="1051" href="#1051">1051</a>         <strong>return</strong> objectDeficit;
<a name="1052" href="#1052">1052</a>     }
<a name="1053" href="#1053">1053</a> 
<a name="1054" href="#1054">1054</a>     <em>/**<em>*</em></em>
<a name="1055" href="#1055">1055</a> <em>     * Create an object, and place it into the pool.</em>
<a name="1056" href="#1056">1056</a> <em>     * addObject() is useful for "pre-loading" a pool with idle objects.</em>
<a name="1057" href="#1057">1057</a> <em>     */</em>
<a name="1058" href="#1058">1058</a>     <strong>public</strong> <strong>synchronized</strong> <strong>void</strong> addObject() throws Exception {
<a name="1059" href="#1059">1059</a>         assertOpen();
<a name="1060" href="#1060">1060</a>         Object obj = _factory.makeObject();
<a name="1061" href="#1061">1061</a>         addObjectToPool(obj, false);
<a name="1062" href="#1062">1062</a>     }
<a name="1063" href="#1063">1063</a> 
<a name="1064" href="#1064">1064</a>     <em class="comment">//--- non-public methods ----------------------------------------</em>
<a name="1065" href="#1065">1065</a> 
<a name="1066" href="#1066">1066</a>     <em>/**<em>*</em></em>
<a name="1067" href="#1067">1067</a> <em>     * Start the eviction thread or service, or when</em>
<a name="1068" href="#1068">1068</a> <em>     * &lt;i>delay&lt;/i> is non-positive, stop it</em>
<a name="1069" href="#1069">1069</a> <em>     * if it is already running.</em>
<a name="1070" href="#1070">1070</a> <em>     */</em>
<a name="1071" href="#1071">1071</a>     <strong>protected</strong> <strong>synchronized</strong> <strong>void</strong> startEvictor(<strong>long</strong> delay) {
<a name="1072" href="#1072">1072</a>         <strong>if</strong>(<strong>null</strong> != _evictor) {
<a name="1073" href="#1073">1073</a>             _evictor.cancel();
<a name="1074" href="#1074">1074</a>             _evictor = <strong>null</strong>;
<a name="1075" href="#1075">1075</a>         }
<a name="1076" href="#1076">1076</a>         <strong>if</strong>(delay > 0) {
<a name="1077" href="#1077">1077</a>             _evictor = <strong>new</strong> Evictor();
<a name="1078" href="#1078">1078</a>             EVICTION_TIMER.schedule(_evictor, delay, delay);
<a name="1079" href="#1079">1079</a>         }
<a name="1080" href="#1080">1080</a>     }
<a name="1081" href="#1081">1081</a> 
<a name="1082" href="#1082">1082</a>     <strong>synchronized</strong> String debugInfo() {
<a name="1083" href="#1083">1083</a>         StringBuffer buf = <strong>new</strong> StringBuffer();
<a name="1084" href="#1084">1084</a>         buf.append(<span class="string">"Active: "</span>).append(getNumActive()).append(<span class="string">"\n"</span>);
<a name="1085" href="#1085">1085</a>         buf.append(<span class="string">"Idle: "</span>).append(getNumIdle()).append(<span class="string">"\n"</span>);
<a name="1086" href="#1086">1086</a>         buf.append(<span class="string">"Idle Objects:\n"</span>);
<a name="1087" href="#1087">1087</a>         Iterator it = _pool.iterator();
<a name="1088" href="#1088">1088</a>         <strong>long</strong> time = System.currentTimeMillis();
<a name="1089" href="#1089">1089</a>         <strong>while</strong>(it.hasNext()) {
<a name="1090" href="#1090">1090</a>             ObjectTimestampPair pair = (ObjectTimestampPair)(it.next());
<a name="1091" href="#1091">1091</a>             buf.append(<span class="string">"\t"</span>).append(pair.value).append(<span class="string">"\t"</span>).append(time - pair.tstamp).append(<span class="string">"\n"</span>);
<a name="1092" href="#1092">1092</a>         }
<a name="1093" href="#1093">1093</a>         <strong>return</strong> buf.toString();
<a name="1094" href="#1094">1094</a>     }
<a name="1095" href="#1095">1095</a> 
<a name="1096" href="#1096">1096</a>     <strong>private</strong> <strong>int</strong> getNumTests() {
<a name="1097" href="#1097">1097</a>         <strong>if</strong>(_numTestsPerEvictionRun >= 0) {
<a name="1098" href="#1098">1098</a>             <strong>return</strong> Math.min(_numTestsPerEvictionRun, _pool.size());
<a name="1099" href="#1099">1099</a>         } <strong>else</strong> {
<a name="1100" href="#1100">1100</a>             <strong>return</strong>(<strong>int</strong>)(Math.ceil((<strong>double</strong>)_pool.size()/Math.abs((<strong>double</strong>)_numTestsPerEvictionRun)));
<a name="1101" href="#1101">1101</a>         }
<a name="1102" href="#1102">1102</a>     }
<a name="1103" href="#1103">1103</a> 
<a name="1104" href="#1104">1104</a>     <em class="comment">//--- inner classes ----------------------------------------------</em>
<a name="1105" href="#1105">1105</a> 
<a name="1106" href="#1106">1106</a>     <em>/**<em>*</em></em>
<a name="1107" href="#1107">1107</a> <em>     * The idle object evictor {@link TimerTask}.</em>
<a name="1108" href="#1108">1108</a> <em>     * @see GenericObjectPool#setTimeBetweenEvictionRunsMillis</em>
<a name="1109" href="#1109">1109</a> <em>     */</em>
<a name="1110" href="#1110">1110</a>     <strong>private</strong> <strong>class</strong> Evictor <strong>extends</strong> TimerTask {
<a name="1111" href="#1111">1111</a>         <strong>public</strong> <strong>void</strong> run() {
<a name="1112" href="#1112">1112</a>             <strong>try</strong> {
<a name="1113" href="#1113">1113</a>                 evict();
<a name="1114" href="#1114">1114</a>             } <strong>catch</strong>(Exception e) {
<a name="1115" href="#1115">1115</a>                 <em class="comment">// ignored</em>
<a name="1116" href="#1116">1116</a>             }
<a name="1117" href="#1117">1117</a>             <strong>try</strong> {
<a name="1118" href="#1118">1118</a>                 ensureMinIdle();
<a name="1119" href="#1119">1119</a>             } <strong>catch</strong>(Exception e) {
<a name="1120" href="#1120">1120</a>                 <em class="comment">// ignored</em>
<a name="1121" href="#1121">1121</a>             }
<a name="1122" href="#1122">1122</a>         }
<a name="1123" href="#1123">1123</a>     }
<a name="1124" href="#1124">1124</a> 
<a name="1125" href="#1125">1125</a>     <em>/**<em>*</em></em>
<a name="1126" href="#1126">1126</a> <em>     * A simple "struct" encapsulating the</em>
<a name="1127" href="#1127">1127</a> <em>     * configuration information for a {@link GenericObjectPool}.</em>
<a name="1128" href="#1128">1128</a> <em>     * @see GenericObjectPool#GenericObjectPool(org.apache.commons.pool.PoolableObjectFactory,org.apache.commons.pool.impl.GenericObjectPool.Config)</em>
<a name="1129" href="#1129">1129</a> <em>     * @see GenericObjectPool#setConfig</em>
<a name="1130" href="#1130">1130</a> <em>     */</em>
<a name="1131" href="#1131">1131</a>     <strong>public</strong> <strong>static</strong> <strong>class</strong> Config {
<a name="1132" href="#1132">1132</a>         <strong>public</strong> <strong>int</strong> maxIdle = GenericObjectPool.DEFAULT_MAX_IDLE;
<a name="1133" href="#1133">1133</a>         <strong>public</strong> <strong>int</strong> minIdle = GenericObjectPool.DEFAULT_MIN_IDLE;
<a name="1134" href="#1134">1134</a>         <strong>public</strong> <strong>int</strong> maxActive = GenericObjectPool.DEFAULT_MAX_ACTIVE;
<a name="1135" href="#1135">1135</a>         <strong>public</strong> <strong>long</strong> maxWait = GenericObjectPool.DEFAULT_MAX_WAIT;
<a name="1136" href="#1136">1136</a>         <strong>public</strong> byte whenExhaustedAction = GenericObjectPool.DEFAULT_WHEN_EXHAUSTED_ACTION;
<a name="1137" href="#1137">1137</a>         <strong>public</strong> <strong>boolean</strong> testOnBorrow = GenericObjectPool.DEFAULT_TEST_ON_BORROW;
<a name="1138" href="#1138">1138</a>         <strong>public</strong> <strong>boolean</strong> testOnReturn = GenericObjectPool.DEFAULT_TEST_ON_RETURN;
<a name="1139" href="#1139">1139</a>         <strong>public</strong> <strong>boolean</strong> testWhileIdle = GenericObjectPool.DEFAULT_TEST_WHILE_IDLE;
<a name="1140" href="#1140">1140</a>         <strong>public</strong> <strong>long</strong> timeBetweenEvictionRunsMillis = GenericObjectPool.DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS;
<a name="1141" href="#1141">1141</a>         <strong>public</strong> <strong>int</strong> numTestsPerEvictionRun =  GenericObjectPool.DEFAULT_NUM_TESTS_PER_EVICTION_RUN;
<a name="1142" href="#1142">1142</a>         <strong>public</strong> <strong>long</strong> minEvictableIdleTimeMillis = GenericObjectPool.DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS;
<a name="1143" href="#1143">1143</a>         <strong>public</strong> <strong>long</strong> softMinEvictableIdleTimeMillis = GenericObjectPool.DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS;
<a name="1144" href="#1144">1144</a>     }
<a name="1145" href="#1145">1145</a> 
<a name="1146" href="#1146">1146</a>     <em class="comment">//--- private attributes ---------------------------------------</em>
<a name="1147" href="#1147">1147</a> 
<a name="1148" href="#1148">1148</a>     <em>/**<em>*</em></em>
<a name="1149" href="#1149">1149</a> <em>     * The cap on the number of idle instances in the pool.</em>
<a name="1150" href="#1150">1150</a> <em>     * @see #setMaxIdle</em>
<a name="1151" href="#1151">1151</a> <em>     * @see #getMaxIdle</em>
<a name="1152" href="#1152">1152</a> <em>     */</em>
<a name="1153" href="#1153">1153</a>     <strong>private</strong> <strong>int</strong> _maxIdle = DEFAULT_MAX_IDLE;
<a name="1154" href="#1154">1154</a> 
<a name="1155" href="#1155">1155</a>     <em>/**<em>*</em></em>
<a name="1156" href="#1156">1156</a> <em>    * The cap on the minimum number of idle instances in the pool.</em>
<a name="1157" href="#1157">1157</a> <em>    * @see #setMinIdle</em>
<a name="1158" href="#1158">1158</a> <em>    * @see #getMinIdle</em>
<a name="1159" href="#1159">1159</a> <em>    */</em>
<a name="1160" href="#1160">1160</a>     <strong>private</strong> <strong>int</strong> _minIdle = DEFAULT_MIN_IDLE;
<a name="1161" href="#1161">1161</a> 
<a name="1162" href="#1162">1162</a>     <em>/**<em>*</em></em>
<a name="1163" href="#1163">1163</a> <em>     * The cap on the total number of active instances from the pool.</em>
<a name="1164" href="#1164">1164</a> <em>     * @see #setMaxActive</em>
<a name="1165" href="#1165">1165</a> <em>     * @see #getMaxActive</em>
<a name="1166" href="#1166">1166</a> <em>     */</em>
<a name="1167" href="#1167">1167</a>     <strong>protected</strong> <strong>int</strong> _maxActive = DEFAULT_MAX_ACTIVE;
<a name="1168" href="#1168">1168</a> 
<a name="1169" href="#1169">1169</a>     <em>/**<em>*</em></em>
<a name="1170" href="#1170">1170</a> <em>     * The maximum amount of time (in millis) the</em>
<a name="1171" href="#1171">1171</a> <em>     * {@link #borrowObject} method should block before throwing</em>
<a name="1172" href="#1172">1172</a> <em>     * an exception when the pool is exhausted and the</em>
<a name="1173" href="#1173">1173</a> <em>     * {@link #getWhenExhaustedAction "when exhausted" action} is</em>
<a name="1174" href="#1174">1174</a> <em>     * {@link #WHEN_EXHAUSTED_BLOCK}.</em>
<a name="1175" href="#1175">1175</a> <em>     *</em>
<a name="1176" href="#1176">1176</a> <em>     * When less than 0, the {@link #borrowObject} method</em>
<a name="1177" href="#1177">1177</a> <em>     * may block indefinitely.</em>
<a name="1178" href="#1178">1178</a> <em>     *</em>
<a name="1179" href="#1179">1179</a> <em>     * @see #setMaxWait</em>
<a name="1180" href="#1180">1180</a> <em>     * @see #getMaxWait</em>
<a name="1181" href="#1181">1181</a> <em>     * @see #WHEN_EXHAUSTED_BLOCK</em>
<a name="1182" href="#1182">1182</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="1183" href="#1183">1183</a> <em>     * @see #getWhenExhaustedAction</em>
<a name="1184" href="#1184">1184</a> <em>     */</em>
<a name="1185" href="#1185">1185</a>     <strong>protected</strong> <strong>long</strong> _maxWait = DEFAULT_MAX_WAIT;
<a name="1186" href="#1186">1186</a> 
<a name="1187" href="#1187">1187</a>     <em>/**<em>*</em></em>
<a name="1188" href="#1188">1188</a> <em>     * The action to take when the {@link #borrowObject} method</em>
<a name="1189" href="#1189">1189</a> <em>     * is invoked when the pool is exhausted (the maximum number</em>
<a name="1190" href="#1190">1190</a> <em>     * of "active" objects has been reached).</em>
<a name="1191" href="#1191">1191</a> <em>     *</em>
<a name="1192" href="#1192">1192</a> <em>     * @see #WHEN_EXHAUSTED_BLOCK</em>
<a name="1193" href="#1193">1193</a> <em>     * @see #WHEN_EXHAUSTED_FAIL</em>
<a name="1194" href="#1194">1194</a> <em>     * @see #WHEN_EXHAUSTED_GROW</em>
<a name="1195" href="#1195">1195</a> <em>     * @see #DEFAULT_WHEN_EXHAUSTED_ACTION</em>
<a name="1196" href="#1196">1196</a> <em>     * @see #setWhenExhaustedAction</em>
<a name="1197" href="#1197">1197</a> <em>     * @see #getWhenExhaustedAction</em>
<a name="1198" href="#1198">1198</a> <em>     */</em>
<a name="1199" href="#1199">1199</a>     <strong>protected</strong> byte _whenExhaustedAction = DEFAULT_WHEN_EXHAUSTED_ACTION;
<a name="1200" href="#1200">1200</a> 
<a name="1201" href="#1201">1201</a>     <em>/**<em>*</em></em>
<a name="1202" href="#1202">1202</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="1203" href="#1203">1203</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="1204" href="#1204">1204</a> <em>     * before being returned by the {@link #borrowObject}</em>
<a name="1205" href="#1205">1205</a> <em>     * method.  If the object fails to validate,</em>
<a name="1206" href="#1206">1206</a> <em>     * it will be dropped from the pool, and we will attempt</em>
<a name="1207" href="#1207">1207</a> <em>     * to borrow another.</em>
<a name="1208" href="#1208">1208</a> <em>     *</em>
<a name="1209" href="#1209">1209</a> <em>     * @see #setTestOnBorrow</em>
<a name="1210" href="#1210">1210</a> <em>     * @see #getTestOnBorrow</em>
<a name="1211" href="#1211">1211</a> <em>     */</em>
<a name="1212" href="#1212">1212</a>     <strong>protected</strong> <strong>boolean</strong> _testOnBorrow = DEFAULT_TEST_ON_BORROW;
<a name="1213" href="#1213">1213</a> 
<a name="1214" href="#1214">1214</a>     <em>/**<em>*</em></em>
<a name="1215" href="#1215">1215</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="1216" href="#1216">1216</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="1217" href="#1217">1217</a> <em>     * before being returned to the pool within the</em>
<a name="1218" href="#1218">1218</a> <em>     * {@link #returnObject}.</em>
<a name="1219" href="#1219">1219</a> <em>     *</em>
<a name="1220" href="#1220">1220</a> <em>     * @see #getTestOnReturn</em>
<a name="1221" href="#1221">1221</a> <em>     * @see #setTestOnReturn</em>
<a name="1222" href="#1222">1222</a> <em>     */</em>
<a name="1223" href="#1223">1223</a>     <strong>private</strong> <strong>boolean</strong> _testOnReturn = DEFAULT_TEST_ON_RETURN;
<a name="1224" href="#1224">1224</a> 
<a name="1225" href="#1225">1225</a>     <em>/**<em>*</em></em>
<a name="1226" href="#1226">1226</a> <em>     * When &lt;tt>true&lt;/tt>, objects will be</em>
<a name="1227" href="#1227">1227</a> <em>     * {@link PoolableObjectFactory#validateObject validated}</em>
<a name="1228" href="#1228">1228</a> <em>     * by the idle object evictor (if any).  If an object</em>
<a name="1229" href="#1229">1229</a> <em>     * fails to validate, it will be dropped from the pool.</em>
<a name="1230" href="#1230">1230</a> <em>     *</em>
<a name="1231" href="#1231">1231</a> <em>     * @see #setTestWhileIdle</em>
<a name="1232" href="#1232">1232</a> <em>     * @see #getTestWhileIdle</em>
<a name="1233" href="#1233">1233</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="1234" href="#1234">1234</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="1235" href="#1235">1235</a> <em>     */</em>
<a name="1236" href="#1236">1236</a>     <strong>private</strong> <strong>boolean</strong> _testWhileIdle = DEFAULT_TEST_WHILE_IDLE;
<a name="1237" href="#1237">1237</a> 
<a name="1238" href="#1238">1238</a>     <em>/**<em>*</em></em>
<a name="1239" href="#1239">1239</a> <em>     * The number of milliseconds to sleep between runs of the</em>
<a name="1240" href="#1240">1240</a> <em>     * idle object evictor thread.</em>
<a name="1241" href="#1241">1241</a> <em>     * When non-positive, no idle object evictor thread will be</em>
<a name="1242" href="#1242">1242</a> <em>     * run.</em>
<a name="1243" href="#1243">1243</a> <em>     *</em>
<a name="1244" href="#1244">1244</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="1245" href="#1245">1245</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="1246" href="#1246">1246</a> <em>     */</em>
<a name="1247" href="#1247">1247</a>     <strong>private</strong> <strong>long</strong> _timeBetweenEvictionRunsMillis = DEFAULT_TIME_BETWEEN_EVICTION_RUNS_MILLIS;
<a name="1248" href="#1248">1248</a> 
<a name="1249" href="#1249">1249</a>     <em>/**<em>*</em></em>
<a name="1250" href="#1250">1250</a> <em>     * The max number of objects to examine during each run of the</em>
<a name="1251" href="#1251">1251</a> <em>     * idle object evictor thread (if any).</em>
<a name="1252" href="#1252">1252</a> <em>     * &lt;p></em>
<a name="1253" href="#1253">1253</a> <em>     * When a negative value is supplied, &lt;tt>ceil({@link #getNumIdle})/abs({@link #getNumTestsPerEvictionRun})&lt;/tt></em>
<a name="1254" href="#1254">1254</a> <em>     * tests will be run.  I.e., when the value is &lt;i>-n&lt;/i>, roughly one &lt;i>n&lt;/i>th of the</em>
<a name="1255" href="#1255">1255</a> <em>     * idle objects will be tested per run.</em>
<a name="1256" href="#1256">1256</a> <em>     *</em>
<a name="1257" href="#1257">1257</a> <em>     * @see #setNumTestsPerEvictionRun</em>
<a name="1258" href="#1258">1258</a> <em>     * @see #getNumTestsPerEvictionRun</em>
<a name="1259" href="#1259">1259</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="1260" href="#1260">1260</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="1261" href="#1261">1261</a> <em>     */</em>
<a name="1262" href="#1262">1262</a>     <strong>private</strong> <strong>int</strong> _numTestsPerEvictionRun =  DEFAULT_NUM_TESTS_PER_EVICTION_RUN;
<a name="1263" href="#1263">1263</a> 
<a name="1264" href="#1264">1264</a>     <em>/**<em>*</em></em>
<a name="1265" href="#1265">1265</a> <em>     * The minimum amount of time an object may sit idle in the pool</em>
<a name="1266" href="#1266">1266</a> <em>     * before it is eligable for eviction by the idle object evictor</em>
<a name="1267" href="#1267">1267</a> <em>     * (if any).</em>
<a name="1268" href="#1268">1268</a> <em>     * When non-positive, no objects will be evicted from the pool</em>
<a name="1269" href="#1269">1269</a> <em>     * due to idle time alone.</em>
<a name="1270" href="#1270">1270</a> <em>     *</em>
<a name="1271" href="#1271">1271</a> <em>     * @see #setMinEvictableIdleTimeMillis</em>
<a name="1272" href="#1272">1272</a> <em>     * @see #getMinEvictableIdleTimeMillis</em>
<a name="1273" href="#1273">1273</a> <em>     * @see #getTimeBetweenEvictionRunsMillis</em>
<a name="1274" href="#1274">1274</a> <em>     * @see #setTimeBetweenEvictionRunsMillis</em>
<a name="1275" href="#1275">1275</a> <em>     */</em>
<a name="1276" href="#1276">1276</a>     <strong>private</strong> <strong>long</strong> _minEvictableIdleTimeMillis = DEFAULT_MIN_EVICTABLE_IDLE_TIME_MILLIS;
<a name="1277" href="#1277">1277</a> 
<a name="1278" href="#1278">1278</a>     <em>/**<em>*</em></em>
<a name="1279" href="#1279">1279</a> <em>     * The minimum amount of time an object may sit idle in the pool</em>
<a name="1280" href="#1280">1280</a> <em>     * before it is eligable for eviction by the idle object evictor</em>
<a name="1281" href="#1281">1281</a> <em>     * (if any), with the extra condition that at least</em>
<a name="1282" href="#1282">1282</a> <em>     * "minIdle" amount of object remain in the pool.</em>
<a name="1283" href="#1283">1283</a> <em>     * When non-positive, no objects will be evicted from the pool</em>
<a name="1284" href="#1284">1284</a> <em>     * due to idle time alone.</em>
<a name="1285" href="#1285">1285</a> <em>     *</em>
<a name="1286" href="#1286">1286</a> <em>     * @see #setSoftMinEvictableIdleTimeMillis</em>
<a name="1287" href="#1287">1287</a> <em>     * @see #getSoftMinEvictableIdleTimeMillis</em>
<a name="1288" href="#1288">1288</a> <em>     */</em>
<a name="1289" href="#1289">1289</a>     <strong>private</strong> <strong>long</strong> _softMinEvictableIdleTimeMillis = DEFAULT_SOFT_MIN_EVICTABLE_IDLE_TIME_MILLIS;
<a name="1290" href="#1290">1290</a> 
<a name="1291" href="#1291">1291</a>     <em>/**<em>* My pool. */</em></em>
<a name="1292" href="#1292">1292</a>     <strong>protected</strong> LinkedList _pool = <strong>null</strong>;
<a name="1293" href="#1293">1293</a> 
<a name="1294" href="#1294">1294</a>     <em>/**<em>* My {@link PoolableObjectFactory}. */</em></em>
<a name="1295" href="#1295">1295</a>     <strong>protected</strong> PoolableObjectFactory _factory = <strong>null</strong>;
<a name="1296" href="#1296">1296</a> 
<a name="1297" href="#1297">1297</a>     <em>/**<em>*</em></em>
<a name="1298" href="#1298">1298</a> <em>     * The number of objects {@link #borrowObject} borrowed</em>
<a name="1299" href="#1299">1299</a> <em>     * from the pool, but not yet returned.</em>
<a name="1300" href="#1300">1300</a> <em>     */</em>
<a name="1301" href="#1301">1301</a>     <strong>protected</strong> <strong>int</strong> _numActive = 0;
<a name="1302" href="#1302">1302</a> 
<a name="1303" href="#1303">1303</a>     <em>/**<em>*</em></em>
<a name="1304" href="#1304">1304</a> <em>     * My idle object eviction {@link TimerTask}, if any.</em>
<a name="1305" href="#1305">1305</a> <em>     */</em>
<a name="1306" href="#1306">1306</a>     <strong>private</strong> Evictor _evictor = <strong>null</strong>;
<a name="1307" href="#1307">1307</a> 
<a name="1308" href="#1308">1308</a>     <em>/**<em>*</em></em>
<a name="1309" href="#1309">1309</a> <em>     * Position in the _pool where the _evictor last stopped.</em>
<a name="1310" href="#1310">1310</a> <em>     */</em>
<a name="1311" href="#1311">1311</a>     <strong>private</strong> <strong>int</strong> evictLastIndex = -1;
<a name="1312" href="#1312">1312</a> }
</pre>
<hr/><div id="footer">This page was automatically generated by <a href="http://maven.apache.org/">Maven</a></div></body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_13) on Thu May 06 06:21:03 GMT 2010 -->
<TITLE>
ObjectIdentityBdbCache (Heritrix 1.14.4)
</TITLE>

<META NAME="date" CONTENT="2010-05-06">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ObjectIdentityBdbCache (Heritrix 1.14.4)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/ObjectIdentityBdbCache.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/archive/util/MimetypeUtils.html" title="class in org.archive.util"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.LowMemoryCanary.html" title="class in org.archive.util"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/archive/util/ObjectIdentityBdbCache.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="ObjectIdentityBdbCache.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.archive.util</FONT>
<BR>
Class ObjectIdentityBdbCache&lt;V&gt;</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>org.archive.util.ObjectIdentityBdbCache&lt;V&gt;</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.io.Closeable, java.io.Serializable, <A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,V&gt;</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>ObjectIdentityBdbCache&lt;V&gt;</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,V&gt;, java.io.Closeable, java.io.Serializable</DL>
</PRE>

<P>
A BDB JE backed object cache. 
 
 Soft references to previously-instantiated objects are held so that
 unless/until an object is garbage collected, subsequent get()s will
 return the exact same object. (If all outside references are lost,
 when the soft reference is broken, the object state -- still 
 accessible to this class via reflective access to a phantom 
 referent --is flushed to disk. The next get() will reconsitute a new
 object, from the disk state.)
 <p/>
 The backing disk is only guaranteed to be up-to-date after a flush 
 of all in-memory values to disk, as can be forced by sync().
 <p/>
 To ensure that changes/mutations to values in this map are coherent and
 consistent at the application level, it is assumed that the application
 level only mutates values that are in this map and does not retain references
 to values longer than necessary.  This allows mappings to be persisted
 during GC without explicit transactions or write operations.
 <p/>
 Based on the earlier CachedBdbMap. 
 <p/>
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>John Erik Halse, stack, gojomo, paul baclace (conversion to ConcurrentMap)</DD>
<DT><B>See Also:</B><DD><A HREF="../../../serialized-form.html#org.archive.util.ObjectIdentityBdbCache">Serialized Form</A></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.LowMemoryCanary.html" title="class in org.archive.util">ObjectIdentityBdbCache.LowMemoryCanary</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.ref.SoftReference&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.LowMemoryCanary.html" title="class in org.archive.util">ObjectIdentityBdbCache.LowMemoryCanary</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#canary">canary</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.concurrent.atomic.AtomicLong</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#count">count</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;com.sleepycat.je.Database</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#db">db</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The BDB JE database used for this instance.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;com.sleepycat.collections.StoredSortedMap&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#diskMap">diskMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Collection view of the BDB JE database used for this instance.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.concurrent.ConcurrentHashMap&lt;java.lang.String,org.archive.util.ObjectIdentityBdbCache.SoftEntry&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#memMap">memMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in-memory map of new/recent/still-referenced-elsewhere instances</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;java.lang.reflect.Field</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#referentField">referentField</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reference to the Reference#referent Field.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.ref.ReferenceQueue&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#refQueue">refQueue</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#ObjectIdentityBdbCache()">ObjectIdentityBdbCache</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#close()">close</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close/release any associated resources</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;com.sleepycat.collections.StoredSortedMap&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#createDiskMap(com.sleepycat.je.Database, com.sleepycat.bind.serial.StoredClassCatalog, java.lang.Class)">createDiskMap</A></B>(com.sleepycat.je.Database&nbsp;database,
              com.sleepycat.bind.serial.StoredClassCatalog&nbsp;classCatalog,
              java.lang.Class&nbsp;valueClass)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#finalize()">finalize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#get(java.lang.String)">get</A></B>(java.lang.String&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get the object under the given key/name</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#getDatabaseName()">getDatabaseName</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#getOrUse(java.lang.String, org.archive.util.Supplier)">getOrUse</A></B>(java.lang.String&nbsp;key,
         <A HREF="../../../org/archive/util/Supplier.html" title="class in org.archive.util">Supplier</A>&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;&nbsp;supplierOrNull)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get the object under the given key/name, using (and remembering)
 the object supplied by the supplier if no prior mapping exists</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#initialize(com.sleepycat.je.Environment, java.lang.String, java.lang.Class, com.sleepycat.bind.serial.StoredClassCatalog)">initialize</A></B>(com.sleepycat.je.Environment&nbsp;env,
           java.lang.String&nbsp;dbName,
           java.lang.Class&nbsp;valueClass,
           com.sleepycat.bind.serial.StoredClassCatalog&nbsp;classCatalog)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call this method when you have an instance when you used the
 default constructor or when you have a deserialized instance that you
 want to reconnect with an extant bdbje environment.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Set&lt;java.lang.String&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#keySet()">keySet</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set of all keys</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;com.sleepycat.je.Database</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#openDatabase(com.sleepycat.je.Environment, java.lang.String)">openDatabase</A></B>(com.sleepycat.je.Environment&nbsp;environment,
             java.lang.String&nbsp;dbName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#pageOutStaleEntries()">pageOutStaleEntries</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An incremental, poll-based expunger.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#size()">size</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count of name-to-object contained</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html#sync()">sync</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sync all in-memory map entries to backing disk store.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="db"><!-- --></A><H3>
db</H3>
<PRE>
protected transient com.sleepycat.je.Database <B>db</B></PRE>
<DL>
<DD>The BDB JE database used for this instance.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="memMap"><!-- --></A><H3>
memMap</H3>
<PRE>
protected transient java.util.concurrent.ConcurrentHashMap&lt;java.lang.String,org.archive.util.ObjectIdentityBdbCache.SoftEntry&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;&gt; <B>memMap</B></PRE>
<DL>
<DD>in-memory map of new/recent/still-referenced-elsewhere instances
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="refQueue"><!-- --></A><H3>
refQueue</H3>
<PRE>
protected transient java.lang.ref.ReferenceQueue&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt; <B>refQueue</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="diskMap"><!-- --></A><H3>
diskMap</H3>
<PRE>
protected transient com.sleepycat.collections.StoredSortedMap&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt; <B>diskMap</B></PRE>
<DL>
<DD>The Collection view of the BDB JE database used for this instance.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="count"><!-- --></A><H3>
count</H3>
<PRE>
protected java.util.concurrent.atomic.AtomicLong <B>count</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="referentField"><!-- --></A><H3>
referentField</H3>
<PRE>
protected static java.lang.reflect.Field <B>referentField</B></PRE>
<DL>
<DD>Reference to the Reference#referent Field.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="canary"><!-- --></A><H3>
canary</H3>
<PRE>
protected transient java.lang.ref.SoftReference&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.LowMemoryCanary.html" title="class in org.archive.util">ObjectIdentityBdbCache.LowMemoryCanary</A>&gt; <B>canary</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="ObjectIdentityBdbCache()"><!-- --></A><H3>
ObjectIdentityBdbCache</H3>
<PRE>
public <B>ObjectIdentityBdbCache</B>()</PRE>
<DL>
<DD>Constructor. You must call
 <CODE>#initialize(Environment, Class, Class, StoredClassCatalog)</CODE>
 to finish construction. Construction is two-stepped to support
 reconnecting a deserialized CachedBdbMap with its backing bdbje
 database.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>dbName</CODE> - Name of the backing db this instance should use.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="initialize(com.sleepycat.je.Environment, java.lang.String, java.lang.Class, com.sleepycat.bind.serial.StoredClassCatalog)"><!-- --></A><H3>
initialize</H3>
<PRE>
public void <B>initialize</B>(com.sleepycat.je.Environment&nbsp;env,
                       java.lang.String&nbsp;dbName,
                       java.lang.Class&nbsp;valueClass,
                       com.sleepycat.bind.serial.StoredClassCatalog&nbsp;classCatalog)
                throws com.sleepycat.je.DatabaseException</PRE>
<DL>
<DD>Call this method when you have an instance when you used the
 default constructor or when you have a deserialized instance that you
 want to reconnect with an extant bdbje environment.  Do not
 call this method if you used the
 <CODE>#CachedBdbMap(File, String, Class, Class)</CODE> constructor.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>env</CODE> - <DD><CODE>keyClass</CODE> - <DD><CODE>valueClass</CODE> - <DD><CODE>classCatalog</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>com.sleepycat.je.DatabaseException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="createDiskMap(com.sleepycat.je.Database, com.sleepycat.bind.serial.StoredClassCatalog, java.lang.Class)"><!-- --></A><H3>
createDiskMap</H3>
<PRE>
protected com.sleepycat.collections.StoredSortedMap&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt; <B>createDiskMap</B>(com.sleepycat.je.Database&nbsp;database,
                                                                                      com.sleepycat.bind.serial.StoredClassCatalog&nbsp;classCatalog,
                                                                                      java.lang.Class&nbsp;valueClass)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="openDatabase(com.sleepycat.je.Environment, java.lang.String)"><!-- --></A><H3>
openDatabase</H3>
<PRE>
protected com.sleepycat.je.Database <B>openDatabase</B>(com.sleepycat.je.Environment&nbsp;environment,
                                                 java.lang.String&nbsp;dbName)
                                          throws com.sleepycat.je.DatabaseException</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>com.sleepycat.je.DatabaseException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="close()"><!-- --></A><H3>
close</H3>
<PRE>
public void <B>close</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#close()">ObjectIdentityCache</A></CODE></B></DD>
<DD>close/release any associated resources
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>close</CODE> in interface <CODE>java.io.Closeable</CODE><DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#close()">close</A></CODE> in interface <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="finalize()"><!-- --></A><H3>
finalize</H3>
<PRE>
protected void <B>finalize</B>()
                 throws java.lang.Throwable</PRE>
<DL>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>finalize</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.Throwable</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="get(java.lang.String)"><!-- --></A><H3>
get</H3>
<PRE>
public <A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A> <B>get</B>(java.lang.String&nbsp;key)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#get(K)">ObjectIdentityCache</A></CODE></B></DD>
<DD>get the object under the given key/name
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#get(K)">get</A></CODE> in interface <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getOrUse(java.lang.String, org.archive.util.Supplier)"><!-- --></A><H3>
getOrUse</H3>
<PRE>
public <A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A> <B>getOrUse</B>(java.lang.String&nbsp;key,
                  <A HREF="../../../org/archive/util/Supplier.html" title="class in org.archive.util">Supplier</A>&lt;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;&nbsp;supplierOrNull)</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#getOrUse(K, org.archive.util.Supplier)">ObjectIdentityCache</A></CODE></B></DD>
<DD>get the object under the given key/name, using (and remembering)
 the object supplied by the supplier if no prior mapping exists
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#getOrUse(K, org.archive.util.Supplier)">getOrUse</A></CODE> in interface <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="keySet()"><!-- --></A><H3>
keySet</H3>
<PRE>
public java.util.Set&lt;java.lang.String&gt; <B>keySet</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#keySet()">ObjectIdentityCache</A></CODE></B></DD>
<DD>set of all keys
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#keySet()">keySet</A></CODE> in interface <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="size()"><!-- --></A><H3>
size</H3>
<PRE>
public int <B>size</B>()</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#size()">ObjectIdentityCache</A></CODE></B></DD>
<DD>count of name-to-object contained
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#size()">size</A></CODE> in interface <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getDatabaseName()"><!-- --></A><H3>
getDatabaseName</H3>
<PRE>
protected java.lang.String <B>getDatabaseName</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sync()"><!-- --></A><H3>
sync</H3>
<PRE>
public void <B>sync</B>()</PRE>
<DL>
<DD>Sync all in-memory map entries to backing disk store.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html#sync()">sync</A></CODE> in interface <CODE><A HREF="../../../org/archive/util/ObjectIdentityCache.html" title="interface in org.archive.util">ObjectIdentityCache</A>&lt;java.lang.String,<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.html" title="type parameter in ObjectIdentityBdbCache">V</A>&gt;</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="pageOutStaleEntries()"><!-- --></A><H3>
pageOutStaleEntries</H3>
<PRE>
void <B>pageOutStaleEntries</B>()</PRE>
<DL>
<DD>An incremental, poll-based expunger.
 
 Package-protected for unit-test visibility.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/ObjectIdentityBdbCache.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../org/archive/util/MimetypeUtils.html" title="class in org.archive.util"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../org/archive/util/ObjectIdentityBdbCache.LowMemoryCanary.html" title="class in org.archive.util"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?org/archive/util/ObjectIdentityBdbCache.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="ObjectIdentityBdbCache.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &copy; 2003-2010 Internet Archive. All Rights Reserved.
</BODY>
</HTML>
